{{
	config(
		materialized = "table"
	)
}}

with

dim_bil_typ_late_actv AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_bil_typ_late_actv")  }}),
dim_actu_and_finc_dervn_mm AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_actu_and_finc_dervn_mm")  }}),
dim_st AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_st")  }}),
dim_mlt_prl AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_mlt_prl")  }}),
work_init_gpng_finc_ins AS (
	SELECT
	*
	FROM {{ source("dbaall","work_init_gpng_finc_ins")  }}),
dim_retro_ratg_late_actv AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_retro_ratg_late_actv")  }}),
work_actu_and_fin_pol AS (
	SELECT
	*
	FROM {{ source("dbaall","work_actu_and_fin_pol")  }}),
dim_exc_late_actv AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_exc_late_actv")  }}),
dim_covg_lob_cls_late_actv AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_covg_lob_cls_late_actv")  }}),
cd AS (
	SELECT
	*
	FROM {{ source("dbaall","cd")  }}),
dim_reins_agmt AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_reins_agmt")  }}),
dim_crcy AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_crcy")  }}),
work_maj_ln_dflt_asmt AS (
	SELECT
	*
	FROM {{ source("dbaall","work_maj_ln_dflt_asmt")  }}),
extl_org AS (
	SELECT
	*
	FROM {{ source("dbaall","extl_org")  }}),
dim_lob_za_gp_cd AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_lob_za_gp_cd")  }}),
dim_ins_pol_and_rlup_late_actv_mm AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_ins_pol_and_rlup_late_actv_mm")  }}),
dim_insr AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_insr")  }}),
cml_agmt AS (
	SELECT
	*
	FROM {{ source("dbaall","cml_agmt")  }}),
extl_org_dtl AS (
	SELECT
	*
	FROM {{ source("dbaall","extl_org_dtl")  }}),
lkup_prem_postal_regn_co AS (
	SELECT
	*
	FROM {{ source("dbaall","lkup_prem_postal_regn_co")  }}),
dim_cmtn_agmt AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_cmtn_agmt")  }}),
dim_dir_assm_cede AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_dir_assm_cede")  }}),
dim_covg_lob AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_covg_lob")  }}),
dim_ctry AS (
	SELECT
	*
	FROM {{ source("dbaall","dim_ctry")  }}),
SQ_WORK_INIT_GPNG_FINC_INS AS (/* ------------ START QUERY --------------- */ WITH LATE_ACTIVE_RECORDS AS (SELECT ASSM_REINS_AGMT_ALT_BUSN_KEY AS WORK_INT_FFPL_PK, CEDE_REINS_AGMT_ALT_BUSN_KEY AS ACC_EXPO_YR_MM, CMTN_AGMT_ALT_BUSN_KEY AS ASSM_REINS_AGMT_ANCHR_ID, INS_POL_AND_RLUP_ALT_BUSN_KEY AS BIL_TYP_CD, ST_ALT_BUSN_KEY AS BULK_TRAN_IND, DIR_ASSM_CEDE_ALT_BUSN_KEY AS CLS_CD, MLT_PRL_ALT_BUSN_KEY AS CEDE_REINS_AGMT_ANCHR_ID, COVG_LOB_CLS_ALT_BUSN_KEY AS CML_AGMT_ANCHR_ID, INSR_ALT_BUSN_KEY AS CMTN_AGMT_ANCHR_ID, EXC_ALT_BUSN_KEY AS CRCY_CD, RETRO_RATG_ALT_BUSN_KEY AS DAC_CD, SUSP_IND AS EXC_CD, TYP_INS_CD AS FIN_ACC_EXPO_YR_MM, RETRO_CEDE_IND AS FIN_CYC_PST_DT, ACC_EXPO_YY AS FIN_PST_YR_MM, FINC_ACC_EXPO_YY AS LOB_ZA_GP_CD, LATE_ACTV_REC_IND AS MP_CD, FINC_INSR_ALT_BUSN_KEY AS OPERT_CO_CD, FINC_COVG_LOB_ALT_BUSN_KEY AS RETRO_RATG_CD, FINC_PREM_ST_ALT_BUSN_KEY AS SRC_POL_EFF_DT, ACTU_AND_FINC_DERVN_ALT_BUSN_KEY AS SUSP_IND FROM dim_actu_and_finc_dervn_mm WHERE TYP_INS_CD = 'F&I' AND LATE_ACTV_REC_IND = 'Y') SELECT NEXTVAL('$$DBOwnerWRK.dbaall.SEQ_WORK_INT_FFPL_FI_PK') AS WORK_INT_FFPL_PK, WIGFI.ACC_EXPO_YR_MM AS ACC_EXPO_YR_MM, WIGFI.ASSM_REINS_AGMT_ANCHR_ID AS ASSM_REINS_AGMT_ANCHR_ID, WIGFI.BIL_TYP_CD AS BIL_TYP_CD, WIGFI.BULK_TRAN_IND AS BULK_TRAN_IND, WIGFI.CLS_CD AS CLS_CD, WIGFI.CEDE_REINS_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, WIGFI.CML_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, WIGFI.CMTN_AGMT_ANCHR_ID AS CMTN_AGMT_ANCHR_ID, WIGFI.CRCY_CD AS CRCY_CD, WIGFI.DAC_CD AS DAC_CD, WIGFI.EXC_CD AS EXC_CD, WIGFI.FIN_ACC_EXPO_YR_MM AS FIN_ACC_EXPO_YR_MM, WIGFI.FIN_CYC_PST_DT AS FIN_CYC_PST_DT, WIGFI.FIN_PST_YR_MM AS FIN_PST_YR_MM, WIGFI.LOB_ZA_GP_CD AS LOB_ZA_GP_CD, WIGFI.MP_CD AS MP_CD, WIGFI.OPERT_CO_CD AS OPERT_CO_CD, WIGFI.RETRO_RATG_CD AS RETRO_RATG_CD, CASE WHEN ISDATE(WIGFI.SRC_POL_EFF_DT, 'YYYYMMDD') = 'true' THEN WIGFI.SRC_POL_EFF_DT WHEN LENGTH(TRIM(WIGFI.SRC_POL_EFF_DT)) = 4 AND ISDATE(WIGFI.SRC_POL_EFF_DT || '0101', 'YYYYMMDD') = 'true' THEN TRIM(WIGFI.SRC_POL_EFF_DT) || '0101' ELSE CAST(LKP_CML_AGMT.POL_EFF_DT AS CHAR) END AS SRC_POL_EFF_DT /* -,WIGFI.SRC_POL_EFF_DT */, WIGFI.SUSP_IND AS SUSP_IND, WIGFI.ST_NBR AS ST_NBR, WIGFI.CMTN_IND AS CMTN_IND, WIGFI.ACTL_LOS_RCVY_IDM_AMT AS ACTL_LOS_RCVY_IDM_AMT, WIGFI.ADJR_ALAE_AMT AS ADJR_ALAE_AMT, WIGFI.ANTCP_LOS_RCVY_IDM_AMT AS ANTCP_LOS_RCVY_IDM_AMT, WIGFI.BASE_ADMIN_FEE_AMT AS BASE_ADMIN_FEE_AMT, WIGFI.BASE_PREM_AMT AS BASE_PREM_AMT, WIGFI.CEDE_FEE_AMT AS CEDE_FEE_AMT, WIGFI.CONTR_CAN_PAID_FEE_AMT AS CONTR_CAN_PAID_FEE_AMT, WIGFI.CONTR_TRNSFR_FEE_AMT AS CONTR_TRNSFR_FEE_AMT, WIGFI.DELR_MRKP_AMT AS DELR_MRKP_AMT, WIGFI.DRCVY_ALAE_AMT AS DRCVY_ALAE_AMT, WIGFI.DRCVY_IDM_LOS_AMT AS DRCVY_IDM_LOS_AMT, WIGFI.DRCVY_RSV_ALAE_AMT AS DRCVY_RSV_ALAE_AMT, WIGFI.DRCVY_RSV_IDM_AMT AS DRCVY_RSV_IDM_AMT, WIGFI.EXCS_TAX_AMT AS EXCS_TAX_AMT, WIGFI.LOSS_FUND_AMT AS LOSS_FUND_AMT, WIGFI.LOSS_STBLZ_FEE_AMT AS LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_BASE_ADMIN_FEE_AMT AS MGMT_ERND_BASE_ADMIN_FEE_AMT, WIGFI.MGMT_ERND_BASE_PREM_AMT AS MGMT_ERND_BASE_PREM_AMT, WIGFI.MGMT_ERND_CHRGCUSTCAN_AMT AS MGMT_ERND_CHRGCUSTCAN_AMT, WIGFI.MGMT_ERND_CONTR_TRNSFR_FEE_AMT AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, WIGFI.MGMT_ERND_DELR_MRKP_AMT AS MGMT_ERND_DELR_MRKP_AMT, WIGFI.MGMT_ERND_LOSS_FUND_AMT AS MGMT_ERND_LOSS_FUND_AMT, WIGFI.MGMT_ERND_LOSS_STBLZ_FEE_AMT AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_MISC_PREM_AMT AS MGMT_ERND_MISC_PREM_AMT, WIGFI.MGMT_ERND_NO_CHRGBCK_FEE_AMT AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_ADV_FEE_AMT AS MGMT_ERND_NONRFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_PROMO_FEE AS MGMT_ERND_NONRFND_PROMO_FEE, WIGFI.MGMT_ERND_OVER_RMT_FEE_AMT AS MGMT_ERND_OVER_RMT_FEE_AMT, WIGFI.MGMT_ERND_PRTNR_COMM_FEE_AMT AS MGMT_ERND_PRTNR_COMM_FEE_AMT, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_1 AS MGMT_ERND_SCS_PREM_COMM_AMT_1, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_2 AS MGMT_ERND_SCS_PREM_COMM_AMT_2, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_3 AS MGMT_ERND_SCS_PREM_COMM_AMT_3, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_4 AS MGMT_ERND_SCS_PREM_COMM_AMT_4, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_5 AS MGMT_ERND_SCS_PREM_COMM_AMT_5, WIGFI.MGMT_ERND_RETRO_FEE_AMT AS MGMT_ERND_RETRO_FEE_AMT, WIGFI.MGMT_ERND_RFND_ADV_FEE_AMT AS MGMT_ERND_RFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_RFND_PROMO_FEE_AMT AS MGMT_ERND_RFND_PROMO_FEE_AMT, WIGFI.MGMT_ERND_SURTY_PREM_AMT AS MGMT_ERND_SURTY_PREM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_COMM_AMT AS MGMT_ERND_VOLM_DISC_COMM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_PREM_AMT AS MGMT_ERND_VOLM_DISC_PREM_AMT, WIGFI.MISC_PREM_AMT AS MISC_PREM_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PALAE_AMT AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PIDM_AMT AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_ALAE_AMT AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_IDM_AMT AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, WIGFI.NO_CHRGBCK_FEE_AMT AS NO_CHRGBCK_FEE_AMT, WIGFI.NONRFND_ADV_FEE_AMT AS NONRFND_ADV_FEE_AMT, WIGFI.NONRFND_PROMO_FEE_AMT AS NONRFND_PROMO_FEE_AMT, WIGFI.OVER_RMT_FEE_AMT AS OVER_RMT_FEE_AMT, WIGFI.POOL_IBNR_CHG_AMT AS POOL_IBNR_CHG_AMT, WIGFI.PRTNR_COMM_FEE_AMT AS PRTNR_COMM_FEE_AMT, WIGFI.SCS_PREM_COMM_AMT_1 AS SCS_PREM_COMM_AMT_1, WIGFI.SCS_PREM_COMM_AMT_2 AS SCS_PREM_COMM_AMT_2, WIGFI.SCS_PREM_COMM_AMT_3 AS SCS_PREM_COMM_AMT_3, WIGFI.SCS_PREM_COMM_AMT_4 AS SCS_PREM_COMM_AMT_4, WIGFI.SCS_PREM_COMM_AMT_5 AS SCS_PREM_COMM_AMT_5, WIGFI.RETRO_FEE_AMT AS RETRO_FEE_AMT, WIGFI.RFND_ADV_FEE_AMT AS RFND_ADV_FEE_AMT, WIGFI.RFND_PROMO_FEE_AMT AS RFND_PROMO_FEE_AMT, WIGFI.SLVG_AND_SUBRO_ALAE_AMT AS SLVG_AND_SUBRO_ALAE_AMT, WIGFI.SLVG_AND_SUBRO_IDM_AMT AS SLVG_AND_SUBRO_IDM_AMT, WIGFI.STATU_ERND_BASE_ADMIN_FEE_AMT AS STATU_ERND_BASE_ADMIN_FEE_AMT, WIGFI.STATU_ERND_BASE_PREM_AMT AS STATU_ERND_BASE_PREM_AMT, WIGFI.STATU_ERND_CHRGCUSTCAN_AMT AS STATU_ERND_CHRGCUSTCAN_AMT, WIGFI.STATU_ERND_DELR_MRKP_AMT AS STATU_ERND_DELR_MRKP_AMT, WIGFI.STATU_ERND_LOSS_FUND_AMT AS STATU_ERND_LOSS_FUND_AMT, WIGFI.STATU_ERND_LOSS_STBLZ_FEE_AMT AS STATU_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.STATU_ERND_MISC_PREM_AMT AS STATU_ERND_MISC_PREM_AMT, WIGFI.STATU_ERND_NO_CHRGBCK_FEE_AMT AS STATU_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.STATU_ERND_NONRFND_ADV_FEE_AMT AS STATU_ERND_NONRFND_ADV_FEE_AMT, WIGFI.STATU_ERND_NONRFND_PROMO_FEE AS STATU_ERND_NONRFND_PROMO_FEE, WIGFI.STATU_ERND_OVER_RMT_FEE_AMT AS STATU_ERND_OVER_RMT_FEE_AMT, WIGFI.STATU_ERND_PRTNR_COMM_FEE_AMT AS STATU_ERND_PRTNR_COMM_FEE_AMT, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_1 AS STATU_ERND_SCS_PREM_COMM_AMT_1, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_2 AS STATU_ERND_SCS_PREM_COMM_AMT_2, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_3 AS STATU_ERND_SCS_PREM_COMM_AMT_3, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_4 AS STATU_ERND_SCS_PREM_COMM_AMT_4, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_5 AS STATU_ERND_SCS_PREM_COMM_AMT_5, WIGFI.STATU_ERND_RETRO_FEE_AMT AS STATU_ERND_RETRO_FEE_AMT, WIGFI.STATU_ERND_RFND_ADV_FEE_AMT AS STATU_ERND_RFND_ADV_FEE_AMT, WIGFI.STATU_ERND_RFND_PROMO_FEE_AMT AS STATU_ERND_RFND_PROMO_FEE_AMT, WIGFI.STATU_ERND_SURTY_PREM_AMT AS STATU_ERND_SURTY_PREM_AMT, WIGFI.STATU_ERND_VOLM_DISC_COMM_AMT AS STATU_ERND_VOLM_DISC_COMM_AMT, WIGFI.STATU_ERND_VOLM_DISC_PREM_AMT AS STATU_ERND_VOLM_DISC_PREM_AMT, WIGFI.SURTY_PREM_AMT AS SURTY_PREM_AMT, WIGFI.ULAE_AMT AS ULAE_AMT, WIGFI.VOLM_DISC_COMM_AMT AS VOLM_DISC_COMM_AMT, WIGFI.VOLM_DISC_PREM_AMT AS VOLM_DISC_PREM_AMT, WIGFI.PREM_TAX_AMT AS PREM_TAX_AMT, WIGFI.ASSET_DEF_FEE_AMT AS ASSET_DEF_FEE_AMT, WIGFI.CTRY_CD AS CTRY_CD, WIGFI.RETRO_CEDE_IND AS RETRO_CEDE_IND, WIGFI.SYS_PRCG_CD AS SYS_PRCG_CD, WIGFI.MGMT_CEDE_FEE_AMT AS MGMT_CEDE_FEE_AMT, WIGFI.MGMT_EXCS_TAX_AMT AS MGMT_EXCS_TAX_AMT, WIGFI.MGMT_PREM_TAX_AMT AS MGMT_PREM_TAX_AMT, WIGFI.STATU_CEDE_FEE_AMT AS STATU_CEDE_FEE_AMT, WIGFI.STATU_ERND_CONTRTRNSFR_FEE_AMT AS STATU_ERND_CONTRTRNSFR_FEE_AMT, WIGFI.STATU_EXCS_TAX_AMT AS STATU_EXCS_TAX_AMT, WIGFI.STATU_PREM_TAX_AMT AS STATU_PREM_TAX_AMT, COALESCE(LKP_BIL_TYPE.BIL_TYP_ALT_BUSN_KEY, -1), COALESCE(LKP_CTRY_CD.CTRY_ALT_BUSN_KEY, -1), COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS LOCAL_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS TRAN_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS CONTR_CRCY_ALT_BUSN_KEY, COALESCE(LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY, -1), COALESCE(LAR.ACTU_AND_FINC_DERVN_ALT_BUSN_KEY, -1), CAST('2999-12-31' AS DATE) AS EFF_TO_TISTMP, WIGFI.STAT_COMM_AMT AS STAT_COMM_AMT, WIGFI.DRVD_FINC_LOS_CATG_CD AS DRVD_FINC_LOS_CATG_CD, WIGFI.CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */ AS CLAIM_LOSS_ADJ_CHARGE_AMT, NOW() AS EFF_FRM_TISTMP FROM (SELECT ACC_EXPO_YR_MM AS WORK_INT_FFPL_PK, ASSM_REINS_AGMT_ANCHR_ID AS ACC_EXPO_YR_MM, BIL_TYP_CD AS ASSM_REINS_AGMT_ANCHR_ID, BULK_TRAN_IND AS BIL_TYP_CD, CLS_CD AS BULK_TRAN_IND, CEDE_REINS_AGMT_ANCHR_ID AS CLS_CD, CML_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, CRCY_CD AS CMTN_AGMT_ANCHR_ID, DAC_CD AS CRCY_CD, EXC_CD AS DAC_CD, FIN_ACC_EXPO_YR_MM AS EXC_CD, FIN_CYC_PST_DT AS FIN_ACC_EXPO_YR_MM, FIN_PST_YR_MM AS FIN_CYC_PST_DT, LOB_ZA_GP_CD AS FIN_PST_YR_MM, MP_CD AS LOB_ZA_GP_CD, OPERT_CO_CD AS MP_CD, RETRO_RATG_CD AS OPERT_CO_CD, SRC_POL_EFF_DT AS RETRO_RATG_CD, SUSP_IND AS SRC_POL_EFF_DT, ST_NBR AS SUSP_IND, CMTN_IND AS ST_NBR, SUM(ACTL_LOS_RCVY_IDM_AMT) AS CMTN_IND, SUM(ADJR_ALAE_AMT) AS ACTL_LOS_RCVY_IDM_AMT, SUM(ANTCP_LOS_RCVY_IDM_AMT) AS ADJR_ALAE_AMT, SUM(BASE_ADMIN_FEE_AMT) AS ANTCP_LOS_RCVY_IDM_AMT, SUM(BASE_PREM_AMT) AS BASE_ADMIN_FEE_AMT, SUM(CEDE_FEE_AMT) AS BASE_PREM_AMT, SUM(CONTR_CAN_PAID_FEE_AMT) AS CEDE_FEE_AMT, SUM(CONTR_TRNSFR_FEE_AMT) AS CONTR_CAN_PAID_FEE_AMT, SUM(DELR_MRKP_AMT) AS CONTR_TRNSFR_FEE_AMT, SUM(DRCVY_ALAE_AMT) AS DELR_MRKP_AMT, SUM(DRCVY_IDM_LOS_AMT) AS DRCVY_ALAE_AMT, SUM(DRCVY_RSV_ALAE_AMT) AS DRCVY_IDM_LOS_AMT, SUM(DRCVY_RSV_IDM_AMT) AS DRCVY_RSV_ALAE_AMT, SUM(EXCS_TAX_AMT) AS DRCVY_RSV_IDM_AMT, SUM(LOSS_FUND_AMT) AS EXCS_TAX_AMT, SUM(LOSS_STBLZ_FEE_AMT) AS LOSS_FUND_AMT, SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) AS LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_BASE_PREM_AMT) AS MGMT_ERND_BASE_ADMIN_FEE_AMT, SUM(MGMT_ERND_CHRGCUSTCAN_AMT) AS MGMT_ERND_BASE_PREM_AMT, SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) AS MGMT_ERND_CHRGCUSTCAN_AMT, SUM(MGMT_ERND_DELR_MRKP_AMT) AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, SUM(MGMT_ERND_LOSS_FUND_AMT) AS MGMT_ERND_DELR_MRKP_AMT, SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) AS MGMT_ERND_LOSS_FUND_AMT, SUM(MGMT_ERND_MISC_PREM_AMT) AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) AS MGMT_ERND_MISC_PREM_AMT, SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, SUM(MGMT_ERND_NONRFND_PROMO_FEE) AS MGMT_ERND_NONRFND_ADV_FEE_AMT, SUM(MGMT_ERND_OVER_RMT_FEE_AMT) AS MGMT_ERND_NONRFND_PROMO_FEE, SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) AS MGMT_ERND_OVER_RMT_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) AS MGMT_ERND_PRTNR_COMM_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) AS MGMT_ERND_SCS_PREM_COMM_AMT_1, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) AS MGMT_ERND_SCS_PREM_COMM_AMT_2, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) AS MGMT_ERND_SCS_PREM_COMM_AMT_3, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) AS MGMT_ERND_SCS_PREM_COMM_AMT_4, SUM(MGMT_ERND_RETRO_FEE_AMT) AS MGMT_ERND_SCS_PREM_COMM_AMT_5, SUM(MGMT_ERND_RFND_ADV_FEE_AMT) AS MGMT_ERND_RETRO_FEE_AMT, SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) AS MGMT_ERND_RFND_ADV_FEE_AMT, SUM(MGMT_ERND_SURTY_PREM_AMT) AS MGMT_ERND_RFND_PROMO_FEE_AMT, SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) AS MGMT_ERND_SURTY_PREM_AMT, SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_COMM_AMT, SUM(MISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) AS MISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, SUM(NO_CHRGBCK_FEE_AMT) AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, SUM(NONRFND_ADV_FEE_AMT) AS NO_CHRGBCK_FEE_AMT, SUM(NONRFND_PROMO_FEE_AMT) AS NONRFND_ADV_FEE_AMT, SUM(OVER_RMT_FEE_AMT) AS NONRFND_PROMO_FEE_AMT, SUM(POOL_IBNR_CHG_AMT) AS OVER_RMT_FEE_AMT, SUM(PRTNR_COMM_FEE_AMT) AS POOL_IBNR_CHG_AMT, SUM(SCS_PREM_COMM_AMT_1) AS PRTNR_COMM_FEE_AMT, SUM(SCS_PREM_COMM_AMT_2) AS SCS_PREM_COMM_AMT_1, SUM(SCS_PREM_COMM_AMT_3) AS SCS_PREM_COMM_AMT_2, SUM(SCS_PREM_COMM_AMT_4) AS SCS_PREM_COMM_AMT_3, SUM(SCS_PREM_COMM_AMT_5) AS SCS_PREM_COMM_AMT_4, SUM(RETRO_FEE_AMT) AS SCS_PREM_COMM_AMT_5, SUM(RFND_ADV_FEE_AMT) AS RETRO_FEE_AMT, SUM(RFND_PROMO_FEE_AMT) AS RFND_ADV_FEE_AMT, SUM(SLVG_AND_SUBRO_ALAE_AMT) AS RFND_PROMO_FEE_AMT, SUM(SLVG_AND_SUBRO_IDM_AMT) AS SLVG_AND_SUBRO_ALAE_AMT, SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) AS SLVG_AND_SUBRO_IDM_AMT, SUM(STATU_ERND_BASE_PREM_AMT) AS STATU_ERND_BASE_ADMIN_FEE_AMT, SUM(STATU_ERND_CHRGCUSTCAN_AMT) AS STATU_ERND_BASE_PREM_AMT, SUM(STATU_ERND_DELR_MRKP_AMT) AS STATU_ERND_CHRGCUSTCAN_AMT, SUM(STATU_ERND_LOSS_FUND_AMT) AS STATU_ERND_DELR_MRKP_AMT, SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) AS STATU_ERND_LOSS_FUND_AMT, SUM(STATU_ERND_MISC_PREM_AMT) AS STATU_ERND_LOSS_STBLZ_FEE_AMT, SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) AS STATU_ERND_MISC_PREM_AMT, SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) AS STATU_ERND_NO_CHRGBCK_FEE_AMT, SUM(STATU_ERND_NONRFND_PROMO_FEE) AS STATU_ERND_NONRFND_ADV_FEE_AMT, SUM(STATU_ERND_OVER_RMT_FEE_AMT) AS STATU_ERND_NONRFND_PROMO_FEE, SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) AS STATU_ERND_OVER_RMT_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) AS STATU_ERND_PRTNR_COMM_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) AS STATU_ERND_SCS_PREM_COMM_AMT_1, SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) AS STATU_ERND_SCS_PREM_COMM_AMT_2, SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) AS STATU_ERND_SCS_PREM_COMM_AMT_3, SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) AS STATU_ERND_SCS_PREM_COMM_AMT_4, SUM(STATU_ERND_RETRO_FEE_AMT) AS STATU_ERND_SCS_PREM_COMM_AMT_5, SUM(STATU_ERND_RFND_ADV_FEE_AMT) AS STATU_ERND_RETRO_FEE_AMT, SUM(STATU_ERND_RFND_PROMO_FEE_AMT) AS STATU_ERND_RFND_ADV_FEE_AMT, SUM(STATU_ERND_SURTY_PREM_AMT) AS STATU_ERND_RFND_PROMO_FEE_AMT, SUM(STATU_ERND_VOLM_DISC_COMM_AMT) AS STATU_ERND_SURTY_PREM_AMT, SUM(STATU_ERND_VOLM_DISC_PREM_AMT) AS STATU_ERND_VOLM_DISC_COMM_AMT, SUM(SURTY_PREM_AMT) AS STATU_ERND_VOLM_DISC_PREM_AMT, SUM(ULAE_AMT) AS SURTY_PREM_AMT, SUM(VOLM_DISC_COMM_AMT) AS ULAE_AMT, SUM(VOLM_DISC_PREM_AMT) AS VOLM_DISC_COMM_AMT, SUM(PREM_TAX_AMT) AS VOLM_DISC_PREM_AMT, SUM(ASSET_DEF_FEE_AMT) AS PREM_TAX_AMT, CTRY_CD AS ASSET_DEF_FEE_AMT, RETRO_CEDE_IND AS CTRY_CD, SYS_PRCG_CD AS RETRO_CEDE_IND, SUM(MGMT_CEDE_FEE_AMT) AS SYS_PRCG_CD, SUM(MGMT_EXCS_TAX_AMT) AS MGMT_CEDE_FEE_AMT, SUM(MGMT_PREM_TAX_AMT) AS MGMT_EXCS_TAX_AMT, SUM(STATU_CEDE_FEE_AMT) AS MGMT_PREM_TAX_AMT, SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) AS STATU_CEDE_FEE_AMT, SUM(STATU_EXCS_TAX_AMT) AS STATU_ERND_CONTRTRNSFR_FEE_AMT, SUM(STATU_PREM_TAX_AMT) AS STATU_EXCS_TAX_AMT, SUM(STAT_COMM_AMT) AS STATU_PREM_TAX_AMT, DRVD_FINC_LOS_CATG_CD AS BIL_TYP_ALT_BUSN_KEY, SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) AS CTRY_ALT_BUSN_KEY /* CR79 */ FROM work_init_gpng_finc_ins WHERE CML_AGMT_ANCHR_ID % 4 = 0 GROUP BY (ACC_EXPO_YR_MM, ASSM_REINS_AGMT_ANCHR_ID, BIL_TYP_CD, BULK_TRAN_IND, CLS_CD, CEDE_REINS_AGMT_ANCHR_ID, CML_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID, CRCY_CD, DAC_CD, EXC_CD, FIN_ACC_EXPO_YR_MM, FIN_CYC_PST_DT, FIN_PST_YR_MM, LOB_ZA_GP_CD, MP_CD, OPERT_CO_CD, RETRO_RATG_CD, SRC_POL_EFF_DT, SUSP_IND, ST_NBR, CMTN_IND, CTRY_CD, RETRO_CEDE_IND, SYS_PRCG_CD, DRVD_FINC_LOS_CATG_CD, CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */) HAVING SUM(ACTL_LOS_RCVY_IDM_AMT) <> 0 OR SUM(ADJR_ALAE_AMT) <> 0 OR SUM(ANTCP_LOS_RCVY_IDM_AMT) <> 0 OR SUM(BASE_ADMIN_FEE_AMT) <> 0 OR SUM(BASE_PREM_AMT) <> 0 OR SUM(CEDE_FEE_AMT) <> 0 OR SUM(CONTR_CAN_PAID_FEE_AMT) <> 0 OR SUM(CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(DELR_MRKP_AMT) <> 0 OR SUM(DRCVY_ALAE_AMT) <> 0 OR SUM(DRCVY_IDM_LOS_AMT) <> 0 OR SUM(DRCVY_RSV_ALAE_AMT) <> 0 OR SUM(DRCVY_RSV_IDM_AMT) <> 0 OR SUM(EXCS_TAX_AMT) <> 0 OR SUM(LOSS_FUND_AMT) <> 0 OR SUM(LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_PREM_AMT) <> 0 OR SUM(MGMT_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(MGMT_ERND_DELR_MRKP_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_FUND_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_MISC_PREM_AMT) <> 0 OR SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(MGMT_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(MGMT_ERND_RETRO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SURTY_PREM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(MISC_PREM_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) <> 0 OR SUM(NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(NONRFND_ADV_FEE_AMT) <> 0 OR SUM(NONRFND_PROMO_FEE_AMT) <> 0 OR SUM(OVER_RMT_FEE_AMT) <> 0 OR SUM(POOL_IBNR_CHG_AMT) <> 0 OR SUM(PRTNR_COMM_FEE_AMT) <> 0 OR SUM(SCS_PREM_COMM_AMT_1) <> 0 OR SUM(SCS_PREM_COMM_AMT_2) <> 0 OR SUM(SCS_PREM_COMM_AMT_3) <> 0 OR SUM(SCS_PREM_COMM_AMT_4) <> 0 OR SUM(SCS_PREM_COMM_AMT_5) <> 0 OR SUM(RETRO_FEE_AMT) <> 0 OR SUM(RFND_ADV_FEE_AMT) <> 0 OR SUM(RFND_PROMO_FEE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_ALAE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_IDM_AMT) <> 0 OR SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(STATU_ERND_BASE_PREM_AMT) <> 0 OR SUM(STATU_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(STATU_ERND_DELR_MRKP_AMT) <> 0 OR SUM(STATU_ERND_LOSS_FUND_AMT) <> 0 OR SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(STATU_ERND_MISC_PREM_AMT) <> 0 OR SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(STATU_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(STATU_ERND_RETRO_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(STATU_ERND_SURTY_PREM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(SURTY_PREM_AMT) <> 0 OR SUM(ULAE_AMT) <> 0 OR SUM(VOLM_DISC_COMM_AMT) <> 0 OR SUM(VOLM_DISC_PREM_AMT) <> 0 OR SUM(PREM_TAX_AMT) <> 0 OR SUM(ASSET_DEF_FEE_AMT) <> 0 OR SUM(MGMT_CEDE_FEE_AMT) <> 0 OR SUM(MGMT_EXCS_TAX_AMT) <> 0 OR SUM(MGMT_PREM_TAX_AMT) <> 0 OR SUM(STATU_CEDE_FEE_AMT) <> 0 OR SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) <> 0 OR SUM(STATU_EXCS_TAX_AMT) <> 0 OR SUM(STATU_PREM_TAX_AMT) <> 0 OR SUM(STAT_COMM_AMT) <> 0 OR SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) <> 0 /* CR79 */) AS WIGFI INNER JOIN lkup_prem_postal_regn_co AS LPPRC ON (WIGFI.OPERT_CO_CD = LPPRC.OPERT_CO_CD AND WIGFI.ST_NBR = LPPRC.PREM_POSTAL_REGN_CD AND WIGFI.FIN_PST_YR_MM >= LPPRC.EFF_FM_CCYYMM AND WIGFI.FIN_PST_YR_MM <= LPPRC.EFF_TO_CCYYMM) LEFT OUTER JOIN cml_agmt AS LKP_CML_AGMT ON (LKP_CML_AGMT.AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_CML_AGMT.ACTV_REC_IND = 'Y') /*
LEFT OUTER JOIN work_prcg_cyc_dt WPCD 
ON WPCD.ACTV_REC_IND = 'Y' And WPCD.TYP_ID = 79
*/ LEFT OUTER JOIN dim_bil_typ_late_actv AS LKP_BIL_TYPE ON (LKP_BIL_TYPE.BIL_TYP_CD = CASE WHEN RTRIM(WIGFI.BIL_TYP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.BIL_TYP_CD) END AND LKP_BIL_TYPE.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ctry AS LKP_CTRY_CD ON (LKP_CTRY_CD.CTRY_NBR = CASE WHEN RTRIM(WIGFI.CTRY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CTRY_CD) END AND LKP_CTRY_CD.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_crcy AS LKP_LOCAL_CRCY ON (LKP_LOCAL_CRCY.CRCY_CD = CASE WHEN RTRIM(WIGFI.CRCY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CRCY_CD) END AND LKP_LOCAL_CRCY.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN ON (LKP_DIM_REIN.REINS_AGMT_ANCHR_ID = WIGFI.ASSM_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN1 ON (LKP_DIM_REIN1.REINS_AGMT_ANCHR_ID = WIGFI.CEDE_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN1.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_cmtn_agmt AS LKP_DIM_CMTN ON (LKP_DIM_CMTN.CMTN_AGMT_ANCHR_ID = WIGFI.CMTN_AGMT_ANCHR_ID AND LKP_DIM_CMTN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ins_pol_and_rlup_late_actv_mm AS LKP_DIM_DIPR ON (LKP_DIM_DIPR.CML_AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_DIM_DIPR.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob AS LKP_DIM_DCL ON (LKP_DIM_DCL.ZA_COVG_CD = CASE WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.LOB_ZA_GP_CD) END AND LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS LKP_DIM_ST ON (LKP_DIM_ST.ST_NBR = CASE WHEN RTRIM(WIGFI.ST_NBR) = '' THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.ST_NBR) END AND LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_dir_assm_cede AS LKP_DIM_DDAC ON (LKP_DIM_DDAC.DIR_ASSM_CEDE_CD = CASE WHEN RTRIM(WIGFI.DAC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.DAC_CD) END AND LKP_DIM_DDAC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_mlt_prl AS LKP_DIM_DMPL ON (LKP_DIM_DMPL.MLT_PRL_CD = CASE WHEN RTRIM(WIGFI.MP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.MP_CD) END AND LKP_DIM_DMPL.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob_cls_late_actv AS LKP_DIM_CLC ON (LKP_DIM_CLC.CLS_CD = CASE WHEN RTRIM(WIGFI.CLS_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CLS_CD) END AND LKP_DIM_CLC.COVG_LOB_ALT_BUSN_KEY = LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LKP_DIM_CLC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS LKP_DIM_DINS ON (LKP_DIM_DINS.OPERT_CO_CD = CASE WHEN RTRIM(WIGFI.OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.OPERT_CO_CD) END AND LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_exc_late_actv AS LKP_DIM_DEXC ON (LKP_DIM_DEXC.EXC_CD = CASE WHEN RTRIM(WIGFI.EXC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.EXC_CD) END AND LKP_DIM_DEXC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_retro_ratg_late_actv AS LKP_DIM_DRR ON (LKP_DIM_DRR.RETRO_RATG_CD = CASE WHEN RTRIM(WIGFI.RETRO_RATG_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.RETRO_RATG_CD) END AND LKP_DIM_DRR.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS H_LKP_DIM_DINS ON (RTRIM(H_LKP_DIM_DINS.OPERT_CO_CD) = CASE WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_OPERT_CO_CD) END AND H_LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS H_LKP_DIM_ST ON (RTRIM(H_LKP_DIM_ST.ST_NBR) = CASE WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) END AND H_LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT JOIN work_actu_and_fin_pol AS AFP ON LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY = AFP.INS_POL_AND_RLUP_ALT_BUSN_KEY AND AFP.LATE_ACTV_REC_IND = 'Y' LEFT JOIN (SELECT DISTINCT LOB_ZA_GP_CD AS WORK_INT_FFPL_PK, ETL_IND AS ACC_EXPO_YR_MM FROM dim_lob_za_gp_cd AS lkp_src) AS DLZ ON DLZ.LOB_ZA_GP_CD = RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) AND ETL_IND = 'N' /* DLZ.LOB_ZA_GP_CD if it is not null then set as Financial LOB ZA Group Code */ LEFT JOIN work_maj_ln_dflt_asmt AS MLDA ON MLDA.MAJ_LN_CD = SUBSTR(RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END), 1, 2) /* - SUBSTR(RTRIM(DECODE(rtrim((WIGFI.LOB_ZA_GP_CD)),'','UNK',NULL,'UNK','null','UNK',WIGFI.LOB_ZA_GP_CD)),1,2) || MLDA.SUB_LN_CD || MLDA.COVG_CD THIS WILL BE APPLY WHEN IN ABOCE FINC CODE IS NULL */ LEFT JOIN cd ON CD.CD_VAL = AFP.POL_SYM_CD AND CD.CD_SCM = 'POLICY_SYMBOL_F&I' AND CD.ACTV_REC_IND = 'Y' /* THEN SET FINC_LOB_ZA_GP_CD ='526001' */ LEFT JOIN (SELECT OPERT_CO_CD AS WORK_INT_FFPL_PK FROM extl_org AS EO, $$DBOwnerATM.dbaall.EXTL_ORG_DTL AS EOD WHERE EO.TYP_ID = 26 AND EO.ROL_PLYR_ANCHR_ID = EOD.ROL_PLYR_ANCHR_ID AND EO.ACTV_REC_IND = 'Y' AND EOD.ACTV_REC_IND = 'Y' AND EOD.DOMCL_LOC_CD = 'CAN') AS ABC ON ABC.OPERT_CO_CD = AFP.OPERT_CO_CD LEFT OUTER JOIN dim_covg_lob AS H_LKP_DIM_DCL ON (RTRIM(H_LKP_DIM_DCL.ZA_COVG_CD) = CASE WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = '' THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) IS NULL THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = 'null' THEN 'UNK' ELSE RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) END AND H_LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN late_active_records AS LAR ON (LAR.ACC_EXPO_YY = SUBSTR(WIGFI.ACC_EXPO_YR_MM, 1, 4) AND LAR.FINC_ACC_EXPO_YY = SUBSTR(WIGFI.FIN_ACC_EXPO_YR_MM, 1, 4) AND LAR.ASSM_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN.REINS_AGMT_ALT_BUSN_KEY AND LAR.CEDE_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN1.REINS_AGMT_ALT_BUSN_KEY AND LAR.CMTN_AGMT_ALT_BUSN_KEY = LKP_DIM_CMTN.CMTN_AGMT_ALT_BUSN_KEY AND LAR.INS_POL_AND_RLUP_ALT_BUSN_KEY = LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY AND LAR.ST_ALT_BUSN_KEY = LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.DIR_ASSM_CEDE_ALT_BUSN_KEY = LKP_DIM_DDAC.DIR_ASSM_CEDE_ALT_BUSN_KEY AND LAR.MLT_PRL_ALT_BUSN_KEY = LKP_DIM_DMPL.MLT_PRL_ALT_BUSN_KEY AND LAR.COVG_LOB_CLS_ALT_BUSN_KEY = COALESCE(LKP_DIM_CLC.COVG_LOB_CLS_ALT_BUSN_KEY, -1) AND LAR.INSR_ALT_BUSN_KEY = LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.EXC_ALT_BUSN_KEY = LKP_DIM_DEXC.EXC_ALT_BUSN_KEY AND LAR.RETRO_RATG_ALT_BUSN_KEY = LKP_DIM_DRR.RETRO_RATG_ALT_BUSN_KEY AND LAR.SUSP_IND = WIGFI.SUSP_IND AND LAR.FINC_INSR_ALT_BUSN_KEY = H_LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.FINC_COVG_LOB_ALT_BUSN_KEY = H_LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LAR.FINC_PREM_ST_ALT_BUSN_KEY = H_LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.RETRO_CEDE_IND = WIGFI.RETRO_CEDE_IND) /* --------- END QUERY --------------- */ UNION ALL SELECT NEXTVAL('$$DBOwnerWRK.dbaall.SEQ_WORK_INT_FFPL_FI_PK') AS WORK_INT_FFPL_PK, WIGFI.ACC_EXPO_YR_MM AS ACC_EXPO_YR_MM, WIGFI.ASSM_REINS_AGMT_ANCHR_ID AS ASSM_REINS_AGMT_ANCHR_ID, WIGFI.BIL_TYP_CD AS BIL_TYP_CD, WIGFI.BULK_TRAN_IND AS BULK_TRAN_IND, WIGFI.CLS_CD AS CLS_CD, WIGFI.CEDE_REINS_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, WIGFI.CML_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, WIGFI.CMTN_AGMT_ANCHR_ID AS CMTN_AGMT_ANCHR_ID, WIGFI.CRCY_CD AS CRCY_CD, WIGFI.DAC_CD AS DAC_CD, WIGFI.EXC_CD AS EXC_CD, WIGFI.FIN_ACC_EXPO_YR_MM AS FIN_ACC_EXPO_YR_MM, WIGFI.FIN_CYC_PST_DT AS FIN_CYC_PST_DT, WIGFI.FIN_PST_YR_MM AS FIN_PST_YR_MM, WIGFI.LOB_ZA_GP_CD AS LOB_ZA_GP_CD, WIGFI.MP_CD AS MP_CD, WIGFI.OPERT_CO_CD AS OPERT_CO_CD, WIGFI.RETRO_RATG_CD AS RETRO_RATG_CD, CASE WHEN ISDATE(WIGFI.SRC_POL_EFF_DT, 'YYYYMMDD') = 'true' THEN WIGFI.SRC_POL_EFF_DT WHEN LENGTH(TRIM(WIGFI.SRC_POL_EFF_DT)) = 4 AND ISDATE(WIGFI.SRC_POL_EFF_DT || '0101', 'YYYYMMDD') = 'true' THEN TRIM(WIGFI.SRC_POL_EFF_DT) || '0101' ELSE CAST(LKP_CML_AGMT.POL_EFF_DT AS CHAR) END AS SRC_POL_EFF_DT /* -,WIGFI.SRC_POL_EFF_DT */, WIGFI.SUSP_IND AS SUSP_IND, WIGFI.ST_NBR AS ST_NBR, WIGFI.CMTN_IND AS CMTN_IND, WIGFI.ACTL_LOS_RCVY_IDM_AMT AS ACTL_LOS_RCVY_IDM_AMT, WIGFI.ADJR_ALAE_AMT AS ADJR_ALAE_AMT, WIGFI.ANTCP_LOS_RCVY_IDM_AMT AS ANTCP_LOS_RCVY_IDM_AMT, WIGFI.BASE_ADMIN_FEE_AMT AS BASE_ADMIN_FEE_AMT, WIGFI.BASE_PREM_AMT AS BASE_PREM_AMT, WIGFI.CEDE_FEE_AMT AS CEDE_FEE_AMT, WIGFI.CONTR_CAN_PAID_FEE_AMT AS CONTR_CAN_PAID_FEE_AMT, WIGFI.CONTR_TRNSFR_FEE_AMT AS CONTR_TRNSFR_FEE_AMT, WIGFI.DELR_MRKP_AMT AS DELR_MRKP_AMT, WIGFI.DRCVY_ALAE_AMT AS DRCVY_ALAE_AMT, WIGFI.DRCVY_IDM_LOS_AMT AS DRCVY_IDM_LOS_AMT, WIGFI.DRCVY_RSV_ALAE_AMT AS DRCVY_RSV_ALAE_AMT, WIGFI.DRCVY_RSV_IDM_AMT AS DRCVY_RSV_IDM_AMT, WIGFI.EXCS_TAX_AMT AS EXCS_TAX_AMT, WIGFI.LOSS_FUND_AMT AS LOSS_FUND_AMT, WIGFI.LOSS_STBLZ_FEE_AMT AS LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_BASE_ADMIN_FEE_AMT AS MGMT_ERND_BASE_ADMIN_FEE_AMT, WIGFI.MGMT_ERND_BASE_PREM_AMT AS MGMT_ERND_BASE_PREM_AMT, WIGFI.MGMT_ERND_CHRGCUSTCAN_AMT AS MGMT_ERND_CHRGCUSTCAN_AMT, WIGFI.MGMT_ERND_CONTR_TRNSFR_FEE_AMT AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, WIGFI.MGMT_ERND_DELR_MRKP_AMT AS MGMT_ERND_DELR_MRKP_AMT, WIGFI.MGMT_ERND_LOSS_FUND_AMT AS MGMT_ERND_LOSS_FUND_AMT, WIGFI.MGMT_ERND_LOSS_STBLZ_FEE_AMT AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_MISC_PREM_AMT AS MGMT_ERND_MISC_PREM_AMT, WIGFI.MGMT_ERND_NO_CHRGBCK_FEE_AMT AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_ADV_FEE_AMT AS MGMT_ERND_NONRFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_PROMO_FEE AS MGMT_ERND_NONRFND_PROMO_FEE, WIGFI.MGMT_ERND_OVER_RMT_FEE_AMT AS MGMT_ERND_OVER_RMT_FEE_AMT, WIGFI.MGMT_ERND_PRTNR_COMM_FEE_AMT AS MGMT_ERND_PRTNR_COMM_FEE_AMT, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_1 AS MGMT_ERND_SCS_PREM_COMM_AMT_1, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_2 AS MGMT_ERND_SCS_PREM_COMM_AMT_2, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_3 AS MGMT_ERND_SCS_PREM_COMM_AMT_3, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_4 AS MGMT_ERND_SCS_PREM_COMM_AMT_4, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_5 AS MGMT_ERND_SCS_PREM_COMM_AMT_5, WIGFI.MGMT_ERND_RETRO_FEE_AMT AS MGMT_ERND_RETRO_FEE_AMT, WIGFI.MGMT_ERND_RFND_ADV_FEE_AMT AS MGMT_ERND_RFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_RFND_PROMO_FEE_AMT AS MGMT_ERND_RFND_PROMO_FEE_AMT, WIGFI.MGMT_ERND_SURTY_PREM_AMT AS MGMT_ERND_SURTY_PREM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_COMM_AMT AS MGMT_ERND_VOLM_DISC_COMM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_PREM_AMT AS MGMT_ERND_VOLM_DISC_PREM_AMT, WIGFI.MISC_PREM_AMT AS MISC_PREM_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PALAE_AMT AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PIDM_AMT AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_ALAE_AMT AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_IDM_AMT AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, WIGFI.NO_CHRGBCK_FEE_AMT AS NO_CHRGBCK_FEE_AMT, WIGFI.NONRFND_ADV_FEE_AMT AS NONRFND_ADV_FEE_AMT, WIGFI.NONRFND_PROMO_FEE_AMT AS NONRFND_PROMO_FEE_AMT, WIGFI.OVER_RMT_FEE_AMT AS OVER_RMT_FEE_AMT, WIGFI.POOL_IBNR_CHG_AMT AS POOL_IBNR_CHG_AMT, WIGFI.PRTNR_COMM_FEE_AMT AS PRTNR_COMM_FEE_AMT, WIGFI.SCS_PREM_COMM_AMT_1 AS SCS_PREM_COMM_AMT_1, WIGFI.SCS_PREM_COMM_AMT_2 AS SCS_PREM_COMM_AMT_2, WIGFI.SCS_PREM_COMM_AMT_3 AS SCS_PREM_COMM_AMT_3, WIGFI.SCS_PREM_COMM_AMT_4 AS SCS_PREM_COMM_AMT_4, WIGFI.SCS_PREM_COMM_AMT_5 AS SCS_PREM_COMM_AMT_5, WIGFI.RETRO_FEE_AMT AS RETRO_FEE_AMT, WIGFI.RFND_ADV_FEE_AMT AS RFND_ADV_FEE_AMT, WIGFI.RFND_PROMO_FEE_AMT AS RFND_PROMO_FEE_AMT, WIGFI.SLVG_AND_SUBRO_ALAE_AMT AS SLVG_AND_SUBRO_ALAE_AMT, WIGFI.SLVG_AND_SUBRO_IDM_AMT AS SLVG_AND_SUBRO_IDM_AMT, WIGFI.STATU_ERND_BASE_ADMIN_FEE_AMT AS STATU_ERND_BASE_ADMIN_FEE_AMT, WIGFI.STATU_ERND_BASE_PREM_AMT AS STATU_ERND_BASE_PREM_AMT, WIGFI.STATU_ERND_CHRGCUSTCAN_AMT AS STATU_ERND_CHRGCUSTCAN_AMT, WIGFI.STATU_ERND_DELR_MRKP_AMT AS STATU_ERND_DELR_MRKP_AMT, WIGFI.STATU_ERND_LOSS_FUND_AMT AS STATU_ERND_LOSS_FUND_AMT, WIGFI.STATU_ERND_LOSS_STBLZ_FEE_AMT AS STATU_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.STATU_ERND_MISC_PREM_AMT AS STATU_ERND_MISC_PREM_AMT, WIGFI.STATU_ERND_NO_CHRGBCK_FEE_AMT AS STATU_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.STATU_ERND_NONRFND_ADV_FEE_AMT AS STATU_ERND_NONRFND_ADV_FEE_AMT, WIGFI.STATU_ERND_NONRFND_PROMO_FEE AS STATU_ERND_NONRFND_PROMO_FEE, WIGFI.STATU_ERND_OVER_RMT_FEE_AMT AS STATU_ERND_OVER_RMT_FEE_AMT, WIGFI.STATU_ERND_PRTNR_COMM_FEE_AMT AS STATU_ERND_PRTNR_COMM_FEE_AMT, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_1 AS STATU_ERND_SCS_PREM_COMM_AMT_1, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_2 AS STATU_ERND_SCS_PREM_COMM_AMT_2, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_3 AS STATU_ERND_SCS_PREM_COMM_AMT_3, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_4 AS STATU_ERND_SCS_PREM_COMM_AMT_4, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_5 AS STATU_ERND_SCS_PREM_COMM_AMT_5, WIGFI.STATU_ERND_RETRO_FEE_AMT AS STATU_ERND_RETRO_FEE_AMT, WIGFI.STATU_ERND_RFND_ADV_FEE_AMT AS STATU_ERND_RFND_ADV_FEE_AMT, WIGFI.STATU_ERND_RFND_PROMO_FEE_AMT AS STATU_ERND_RFND_PROMO_FEE_AMT, WIGFI.STATU_ERND_SURTY_PREM_AMT AS STATU_ERND_SURTY_PREM_AMT, WIGFI.STATU_ERND_VOLM_DISC_COMM_AMT AS STATU_ERND_VOLM_DISC_COMM_AMT, WIGFI.STATU_ERND_VOLM_DISC_PREM_AMT AS STATU_ERND_VOLM_DISC_PREM_AMT, WIGFI.SURTY_PREM_AMT AS SURTY_PREM_AMT, WIGFI.ULAE_AMT AS ULAE_AMT, WIGFI.VOLM_DISC_COMM_AMT AS VOLM_DISC_COMM_AMT, WIGFI.VOLM_DISC_PREM_AMT AS VOLM_DISC_PREM_AMT, WIGFI.PREM_TAX_AMT AS PREM_TAX_AMT, WIGFI.ASSET_DEF_FEE_AMT AS ASSET_DEF_FEE_AMT, WIGFI.CTRY_CD AS CTRY_CD, WIGFI.RETRO_CEDE_IND AS RETRO_CEDE_IND, WIGFI.SYS_PRCG_CD AS SYS_PRCG_CD, WIGFI.MGMT_CEDE_FEE_AMT AS MGMT_CEDE_FEE_AMT, WIGFI.MGMT_EXCS_TAX_AMT AS MGMT_EXCS_TAX_AMT, WIGFI.MGMT_PREM_TAX_AMT AS MGMT_PREM_TAX_AMT, WIGFI.STATU_CEDE_FEE_AMT AS STATU_CEDE_FEE_AMT, WIGFI.STATU_ERND_CONTRTRNSFR_FEE_AMT AS STATU_ERND_CONTRTRNSFR_FEE_AMT, WIGFI.STATU_EXCS_TAX_AMT AS STATU_EXCS_TAX_AMT, WIGFI.STATU_PREM_TAX_AMT AS STATU_PREM_TAX_AMT, COALESCE(LKP_BIL_TYPE.BIL_TYP_ALT_BUSN_KEY, -1), COALESCE(LKP_CTRY_CD.CTRY_ALT_BUSN_KEY, -1), COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS LOCAL_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS TRAN_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS CONTR_CRCY_ALT_BUSN_KEY, COALESCE(LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY, -1), COALESCE(LAR.ACTU_AND_FINC_DERVN_ALT_BUSN_KEY, -1), CAST('2999-12-31' AS DATE) AS EFF_TO_TISTMP, WIGFI.STAT_COMM_AMT AS STAT_COMM_AMT, WIGFI.DRVD_FINC_LOS_CATG_CD AS DRVD_FINC_LOS_CATG_CD, WIGFI.CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */ AS CLAIM_LOSS_ADJ_CHARGE_AMT, NOW() AS EFF_FRM_TISTMP FROM (SELECT ACC_EXPO_YR_MM AS WORK_INT_FFPL_PK, ASSM_REINS_AGMT_ANCHR_ID AS ACC_EXPO_YR_MM, BIL_TYP_CD AS ASSM_REINS_AGMT_ANCHR_ID, BULK_TRAN_IND AS BIL_TYP_CD, CLS_CD AS BULK_TRAN_IND, CEDE_REINS_AGMT_ANCHR_ID AS CLS_CD, CML_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, CRCY_CD AS CMTN_AGMT_ANCHR_ID, DAC_CD AS CRCY_CD, EXC_CD AS DAC_CD, FIN_ACC_EXPO_YR_MM AS EXC_CD, FIN_CYC_PST_DT AS FIN_ACC_EXPO_YR_MM, FIN_PST_YR_MM AS FIN_CYC_PST_DT, LOB_ZA_GP_CD AS FIN_PST_YR_MM, MP_CD AS LOB_ZA_GP_CD, OPERT_CO_CD AS MP_CD, RETRO_RATG_CD AS OPERT_CO_CD, SRC_POL_EFF_DT AS RETRO_RATG_CD, SUSP_IND AS SRC_POL_EFF_DT, ST_NBR AS SUSP_IND, CMTN_IND AS ST_NBR, SUM(ACTL_LOS_RCVY_IDM_AMT) AS CMTN_IND, SUM(ADJR_ALAE_AMT) AS ACTL_LOS_RCVY_IDM_AMT, SUM(ANTCP_LOS_RCVY_IDM_AMT) AS ADJR_ALAE_AMT, SUM(BASE_ADMIN_FEE_AMT) AS ANTCP_LOS_RCVY_IDM_AMT, SUM(BASE_PREM_AMT) AS BASE_ADMIN_FEE_AMT, SUM(CEDE_FEE_AMT) AS BASE_PREM_AMT, SUM(CONTR_CAN_PAID_FEE_AMT) AS CEDE_FEE_AMT, SUM(CONTR_TRNSFR_FEE_AMT) AS CONTR_CAN_PAID_FEE_AMT, SUM(DELR_MRKP_AMT) AS CONTR_TRNSFR_FEE_AMT, SUM(DRCVY_ALAE_AMT) AS DELR_MRKP_AMT, SUM(DRCVY_IDM_LOS_AMT) AS DRCVY_ALAE_AMT, SUM(DRCVY_RSV_ALAE_AMT) AS DRCVY_IDM_LOS_AMT, SUM(DRCVY_RSV_IDM_AMT) AS DRCVY_RSV_ALAE_AMT, SUM(EXCS_TAX_AMT) AS DRCVY_RSV_IDM_AMT, SUM(LOSS_FUND_AMT) AS EXCS_TAX_AMT, SUM(LOSS_STBLZ_FEE_AMT) AS LOSS_FUND_AMT, SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) AS LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_BASE_PREM_AMT) AS MGMT_ERND_BASE_ADMIN_FEE_AMT, SUM(MGMT_ERND_CHRGCUSTCAN_AMT) AS MGMT_ERND_BASE_PREM_AMT, SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) AS MGMT_ERND_CHRGCUSTCAN_AMT, SUM(MGMT_ERND_DELR_MRKP_AMT) AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, SUM(MGMT_ERND_LOSS_FUND_AMT) AS MGMT_ERND_DELR_MRKP_AMT, SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) AS MGMT_ERND_LOSS_FUND_AMT, SUM(MGMT_ERND_MISC_PREM_AMT) AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) AS MGMT_ERND_MISC_PREM_AMT, SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, SUM(MGMT_ERND_NONRFND_PROMO_FEE) AS MGMT_ERND_NONRFND_ADV_FEE_AMT, SUM(MGMT_ERND_OVER_RMT_FEE_AMT) AS MGMT_ERND_NONRFND_PROMO_FEE, SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) AS MGMT_ERND_OVER_RMT_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) AS MGMT_ERND_PRTNR_COMM_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) AS MGMT_ERND_SCS_PREM_COMM_AMT_1, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) AS MGMT_ERND_SCS_PREM_COMM_AMT_2, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) AS MGMT_ERND_SCS_PREM_COMM_AMT_3, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) AS MGMT_ERND_SCS_PREM_COMM_AMT_4, SUM(MGMT_ERND_RETRO_FEE_AMT) AS MGMT_ERND_SCS_PREM_COMM_AMT_5, SUM(MGMT_ERND_RFND_ADV_FEE_AMT) AS MGMT_ERND_RETRO_FEE_AMT, SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) AS MGMT_ERND_RFND_ADV_FEE_AMT, SUM(MGMT_ERND_SURTY_PREM_AMT) AS MGMT_ERND_RFND_PROMO_FEE_AMT, SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) AS MGMT_ERND_SURTY_PREM_AMT, SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_COMM_AMT, SUM(MISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) AS MISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, SUM(NO_CHRGBCK_FEE_AMT) AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, SUM(NONRFND_ADV_FEE_AMT) AS NO_CHRGBCK_FEE_AMT, SUM(NONRFND_PROMO_FEE_AMT) AS NONRFND_ADV_FEE_AMT, SUM(OVER_RMT_FEE_AMT) AS NONRFND_PROMO_FEE_AMT, SUM(POOL_IBNR_CHG_AMT) AS OVER_RMT_FEE_AMT, SUM(PRTNR_COMM_FEE_AMT) AS POOL_IBNR_CHG_AMT, SUM(SCS_PREM_COMM_AMT_1) AS PRTNR_COMM_FEE_AMT, SUM(SCS_PREM_COMM_AMT_2) AS SCS_PREM_COMM_AMT_1, SUM(SCS_PREM_COMM_AMT_3) AS SCS_PREM_COMM_AMT_2, SUM(SCS_PREM_COMM_AMT_4) AS SCS_PREM_COMM_AMT_3, SUM(SCS_PREM_COMM_AMT_5) AS SCS_PREM_COMM_AMT_4, SUM(RETRO_FEE_AMT) AS SCS_PREM_COMM_AMT_5, SUM(RFND_ADV_FEE_AMT) AS RETRO_FEE_AMT, SUM(RFND_PROMO_FEE_AMT) AS RFND_ADV_FEE_AMT, SUM(SLVG_AND_SUBRO_ALAE_AMT) AS RFND_PROMO_FEE_AMT, SUM(SLVG_AND_SUBRO_IDM_AMT) AS SLVG_AND_SUBRO_ALAE_AMT, SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) AS SLVG_AND_SUBRO_IDM_AMT, SUM(STATU_ERND_BASE_PREM_AMT) AS STATU_ERND_BASE_ADMIN_FEE_AMT, SUM(STATU_ERND_CHRGCUSTCAN_AMT) AS STATU_ERND_BASE_PREM_AMT, SUM(STATU_ERND_DELR_MRKP_AMT) AS STATU_ERND_CHRGCUSTCAN_AMT, SUM(STATU_ERND_LOSS_FUND_AMT) AS STATU_ERND_DELR_MRKP_AMT, SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) AS STATU_ERND_LOSS_FUND_AMT, SUM(STATU_ERND_MISC_PREM_AMT) AS STATU_ERND_LOSS_STBLZ_FEE_AMT, SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) AS STATU_ERND_MISC_PREM_AMT, SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) AS STATU_ERND_NO_CHRGBCK_FEE_AMT, SUM(STATU_ERND_NONRFND_PROMO_FEE) AS STATU_ERND_NONRFND_ADV_FEE_AMT, SUM(STATU_ERND_OVER_RMT_FEE_AMT) AS STATU_ERND_NONRFND_PROMO_FEE, SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) AS STATU_ERND_OVER_RMT_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) AS STATU_ERND_PRTNR_COMM_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) AS STATU_ERND_SCS_PREM_COMM_AMT_1, SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) AS STATU_ERND_SCS_PREM_COMM_AMT_2, SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) AS STATU_ERND_SCS_PREM_COMM_AMT_3, SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) AS STATU_ERND_SCS_PREM_COMM_AMT_4, SUM(STATU_ERND_RETRO_FEE_AMT) AS STATU_ERND_SCS_PREM_COMM_AMT_5, SUM(STATU_ERND_RFND_ADV_FEE_AMT) AS STATU_ERND_RETRO_FEE_AMT, SUM(STATU_ERND_RFND_PROMO_FEE_AMT) AS STATU_ERND_RFND_ADV_FEE_AMT, SUM(STATU_ERND_SURTY_PREM_AMT) AS STATU_ERND_RFND_PROMO_FEE_AMT, SUM(STATU_ERND_VOLM_DISC_COMM_AMT) AS STATU_ERND_SURTY_PREM_AMT, SUM(STATU_ERND_VOLM_DISC_PREM_AMT) AS STATU_ERND_VOLM_DISC_COMM_AMT, SUM(SURTY_PREM_AMT) AS STATU_ERND_VOLM_DISC_PREM_AMT, SUM(ULAE_AMT) AS SURTY_PREM_AMT, SUM(VOLM_DISC_COMM_AMT) AS ULAE_AMT, SUM(VOLM_DISC_PREM_AMT) AS VOLM_DISC_COMM_AMT, SUM(PREM_TAX_AMT) AS VOLM_DISC_PREM_AMT, SUM(ASSET_DEF_FEE_AMT) AS PREM_TAX_AMT, CTRY_CD AS ASSET_DEF_FEE_AMT, RETRO_CEDE_IND AS CTRY_CD, SYS_PRCG_CD AS RETRO_CEDE_IND, SUM(MGMT_CEDE_FEE_AMT) AS SYS_PRCG_CD, SUM(MGMT_EXCS_TAX_AMT) AS MGMT_CEDE_FEE_AMT, SUM(MGMT_PREM_TAX_AMT) AS MGMT_EXCS_TAX_AMT, SUM(STATU_CEDE_FEE_AMT) AS MGMT_PREM_TAX_AMT, SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) AS STATU_CEDE_FEE_AMT, SUM(STATU_EXCS_TAX_AMT) AS STATU_ERND_CONTRTRNSFR_FEE_AMT, SUM(STATU_PREM_TAX_AMT) AS STATU_EXCS_TAX_AMT, SUM(STAT_COMM_AMT) AS STATU_PREM_TAX_AMT, DRVD_FINC_LOS_CATG_CD AS BIL_TYP_ALT_BUSN_KEY, SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) AS CTRY_ALT_BUSN_KEY /* CR79 */ FROM work_init_gpng_finc_ins WHERE CML_AGMT_ANCHR_ID % 4 = 1 GROUP BY (ACC_EXPO_YR_MM, ASSM_REINS_AGMT_ANCHR_ID, BIL_TYP_CD, BULK_TRAN_IND, CLS_CD, CEDE_REINS_AGMT_ANCHR_ID, CML_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID, CRCY_CD, DAC_CD, EXC_CD, FIN_ACC_EXPO_YR_MM, FIN_CYC_PST_DT, FIN_PST_YR_MM, LOB_ZA_GP_CD, MP_CD, OPERT_CO_CD, RETRO_RATG_CD, SRC_POL_EFF_DT, SUSP_IND, ST_NBR, CMTN_IND, CTRY_CD, RETRO_CEDE_IND, SYS_PRCG_CD, DRVD_FINC_LOS_CATG_CD, CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */) HAVING SUM(ACTL_LOS_RCVY_IDM_AMT) <> 0 OR SUM(ADJR_ALAE_AMT) <> 0 OR SUM(ANTCP_LOS_RCVY_IDM_AMT) <> 0 OR SUM(BASE_ADMIN_FEE_AMT) <> 0 OR SUM(BASE_PREM_AMT) <> 0 OR SUM(CEDE_FEE_AMT) <> 0 OR SUM(CONTR_CAN_PAID_FEE_AMT) <> 0 OR SUM(CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(DELR_MRKP_AMT) <> 0 OR SUM(DRCVY_ALAE_AMT) <> 0 OR SUM(DRCVY_IDM_LOS_AMT) <> 0 OR SUM(DRCVY_RSV_ALAE_AMT) <> 0 OR SUM(DRCVY_RSV_IDM_AMT) <> 0 OR SUM(EXCS_TAX_AMT) <> 0 OR SUM(LOSS_FUND_AMT) <> 0 OR SUM(LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_PREM_AMT) <> 0 OR SUM(MGMT_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(MGMT_ERND_DELR_MRKP_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_FUND_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_MISC_PREM_AMT) <> 0 OR SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(MGMT_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(MGMT_ERND_RETRO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SURTY_PREM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(MISC_PREM_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) <> 0 OR SUM(NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(NONRFND_ADV_FEE_AMT) <> 0 OR SUM(NONRFND_PROMO_FEE_AMT) <> 0 OR SUM(OVER_RMT_FEE_AMT) <> 0 OR SUM(POOL_IBNR_CHG_AMT) <> 0 OR SUM(PRTNR_COMM_FEE_AMT) <> 0 OR SUM(SCS_PREM_COMM_AMT_1) <> 0 OR SUM(SCS_PREM_COMM_AMT_2) <> 0 OR SUM(SCS_PREM_COMM_AMT_3) <> 0 OR SUM(SCS_PREM_COMM_AMT_4) <> 0 OR SUM(SCS_PREM_COMM_AMT_5) <> 0 OR SUM(RETRO_FEE_AMT) <> 0 OR SUM(RFND_ADV_FEE_AMT) <> 0 OR SUM(RFND_PROMO_FEE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_ALAE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_IDM_AMT) <> 0 OR SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(STATU_ERND_BASE_PREM_AMT) <> 0 OR SUM(STATU_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(STATU_ERND_DELR_MRKP_AMT) <> 0 OR SUM(STATU_ERND_LOSS_FUND_AMT) <> 0 OR SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(STATU_ERND_MISC_PREM_AMT) <> 0 OR SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(STATU_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(STATU_ERND_RETRO_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(STATU_ERND_SURTY_PREM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(SURTY_PREM_AMT) <> 0 OR SUM(ULAE_AMT) <> 0 OR SUM(VOLM_DISC_COMM_AMT) <> 0 OR SUM(VOLM_DISC_PREM_AMT) <> 0 OR SUM(PREM_TAX_AMT) <> 0 OR SUM(ASSET_DEF_FEE_AMT) <> 0 OR SUM(MGMT_CEDE_FEE_AMT) <> 0 OR SUM(MGMT_EXCS_TAX_AMT) <> 0 OR SUM(MGMT_PREM_TAX_AMT) <> 0 OR SUM(STATU_CEDE_FEE_AMT) <> 0 OR SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) <> 0 OR SUM(STATU_EXCS_TAX_AMT) <> 0 OR SUM(STATU_PREM_TAX_AMT) <> 0 OR SUM(STAT_COMM_AMT) <> 0 OR SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) <> 0 /* CR79 */) AS WIGFI INNER JOIN lkup_prem_postal_regn_co AS LPPRC ON (WIGFI.OPERT_CO_CD = LPPRC.OPERT_CO_CD AND WIGFI.ST_NBR = LPPRC.PREM_POSTAL_REGN_CD AND WIGFI.FIN_PST_YR_MM >= LPPRC.EFF_FM_CCYYMM AND WIGFI.FIN_PST_YR_MM <= LPPRC.EFF_TO_CCYYMM) LEFT OUTER JOIN cml_agmt AS LKP_CML_AGMT ON (LKP_CML_AGMT.AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_CML_AGMT.ACTV_REC_IND = 'Y') /*
LEFT OUTER JOIN work_prcg_cyc_dt WPCD 
ON WPCD.ACTV_REC_IND = 'Y' And WPCD.TYP_ID = 79
*/ LEFT OUTER JOIN dim_bil_typ_late_actv AS LKP_BIL_TYPE ON (LKP_BIL_TYPE.BIL_TYP_CD = CASE WHEN RTRIM(WIGFI.BIL_TYP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.BIL_TYP_CD) END AND LKP_BIL_TYPE.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ctry AS LKP_CTRY_CD ON (LKP_CTRY_CD.CTRY_NBR = CASE WHEN RTRIM(WIGFI.CTRY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CTRY_CD) END AND LKP_CTRY_CD.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_crcy AS LKP_LOCAL_CRCY ON (LKP_LOCAL_CRCY.CRCY_CD = CASE WHEN RTRIM(WIGFI.CRCY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CRCY_CD) END AND LKP_LOCAL_CRCY.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN ON (LKP_DIM_REIN.REINS_AGMT_ANCHR_ID = WIGFI.ASSM_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN1 ON (LKP_DIM_REIN1.REINS_AGMT_ANCHR_ID = WIGFI.CEDE_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN1.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_cmtn_agmt AS LKP_DIM_CMTN ON (LKP_DIM_CMTN.CMTN_AGMT_ANCHR_ID = WIGFI.CMTN_AGMT_ANCHR_ID AND LKP_DIM_CMTN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ins_pol_and_rlup_late_actv_mm AS LKP_DIM_DIPR ON (LKP_DIM_DIPR.CML_AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_DIM_DIPR.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob AS LKP_DIM_DCL ON (LKP_DIM_DCL.ZA_COVG_CD = CASE WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.LOB_ZA_GP_CD) END AND LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS LKP_DIM_ST ON (LKP_DIM_ST.ST_NBR = CASE WHEN RTRIM(WIGFI.ST_NBR) = '' THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.ST_NBR) END AND LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_dir_assm_cede AS LKP_DIM_DDAC ON (LKP_DIM_DDAC.DIR_ASSM_CEDE_CD = CASE WHEN RTRIM(WIGFI.DAC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.DAC_CD) END AND LKP_DIM_DDAC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_mlt_prl AS LKP_DIM_DMPL ON (LKP_DIM_DMPL.MLT_PRL_CD = CASE WHEN RTRIM(WIGFI.MP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.MP_CD) END AND LKP_DIM_DMPL.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob_cls_late_actv AS LKP_DIM_CLC ON (LKP_DIM_CLC.CLS_CD = CASE WHEN RTRIM(WIGFI.CLS_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CLS_CD) END AND LKP_DIM_CLC.COVG_LOB_ALT_BUSN_KEY = LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LKP_DIM_CLC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS LKP_DIM_DINS ON (LKP_DIM_DINS.OPERT_CO_CD = CASE WHEN RTRIM(WIGFI.OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.OPERT_CO_CD) END AND LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_exc_late_actv AS LKP_DIM_DEXC ON (LKP_DIM_DEXC.EXC_CD = CASE WHEN RTRIM(WIGFI.EXC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.EXC_CD) END AND LKP_DIM_DEXC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_retro_ratg_late_actv AS LKP_DIM_DRR ON (LKP_DIM_DRR.RETRO_RATG_CD = CASE WHEN RTRIM(WIGFI.RETRO_RATG_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.RETRO_RATG_CD) END AND LKP_DIM_DRR.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS H_LKP_DIM_DINS ON (RTRIM(H_LKP_DIM_DINS.OPERT_CO_CD) = CASE WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_OPERT_CO_CD) END AND H_LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS H_LKP_DIM_ST ON (RTRIM(H_LKP_DIM_ST.ST_NBR) = CASE WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) END AND H_LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT JOIN work_actu_and_fin_pol AS AFP ON LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY = AFP.INS_POL_AND_RLUP_ALT_BUSN_KEY AND AFP.LATE_ACTV_REC_IND = 'Y' LEFT JOIN (SELECT DISTINCT LOB_ZA_GP_CD AS WORK_INT_FFPL_PK, ETL_IND AS ACC_EXPO_YR_MM FROM dim_lob_za_gp_cd AS lkp_src) AS DLZ ON DLZ.LOB_ZA_GP_CD = RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) AND ETL_IND = 'N' /* DLZ.LOB_ZA_GP_CD if it is not null then set as Financial LOB ZA Group Code */ LEFT JOIN work_maj_ln_dflt_asmt AS MLDA ON MLDA.MAJ_LN_CD = SUBSTR(RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END), 1, 2) /* - SUBSTR(RTRIM(DECODE(rtrim((WIGFI.LOB_ZA_GP_CD)),'','UNK',NULL,'UNK','null','UNK',WIGFI.LOB_ZA_GP_CD)),1,2) || MLDA.SUB_LN_CD || MLDA.COVG_CD THIS WILL BE APPLY WHEN IN ABOCE FINC CODE IS NULL */ LEFT JOIN cd ON CD.CD_VAL = AFP.POL_SYM_CD AND CD.CD_SCM = 'POLICY_SYMBOL_F&I' AND CD.ACTV_REC_IND = 'Y' /* THEN SET FINC_LOB_ZA_GP_CD ='526001' */ LEFT JOIN (SELECT OPERT_CO_CD AS WORK_INT_FFPL_PK FROM extl_org AS EO, $$DBOwnerATM.dbaall.EXTL_ORG_DTL AS EOD WHERE EO.TYP_ID = 26 AND EO.ROL_PLYR_ANCHR_ID = EOD.ROL_PLYR_ANCHR_ID AND EO.ACTV_REC_IND = 'Y' AND EOD.ACTV_REC_IND = 'Y' AND EOD.DOMCL_LOC_CD = 'CAN') AS ABC ON ABC.OPERT_CO_CD = AFP.OPERT_CO_CD LEFT OUTER JOIN dim_covg_lob AS H_LKP_DIM_DCL ON (RTRIM(H_LKP_DIM_DCL.ZA_COVG_CD) = CASE WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = '' THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) IS NULL THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = 'null' THEN 'UNK' ELSE RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) END AND H_LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN late_active_records AS LAR ON (LAR.ACC_EXPO_YY = SUBSTR(WIGFI.ACC_EXPO_YR_MM, 1, 4) AND LAR.FINC_ACC_EXPO_YY = SUBSTR(WIGFI.FIN_ACC_EXPO_YR_MM, 1, 4) AND LAR.ASSM_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN.REINS_AGMT_ALT_BUSN_KEY AND LAR.CEDE_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN1.REINS_AGMT_ALT_BUSN_KEY AND LAR.CMTN_AGMT_ALT_BUSN_KEY = LKP_DIM_CMTN.CMTN_AGMT_ALT_BUSN_KEY AND LAR.INS_POL_AND_RLUP_ALT_BUSN_KEY = LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY AND LAR.ST_ALT_BUSN_KEY = LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.DIR_ASSM_CEDE_ALT_BUSN_KEY = LKP_DIM_DDAC.DIR_ASSM_CEDE_ALT_BUSN_KEY AND LAR.MLT_PRL_ALT_BUSN_KEY = LKP_DIM_DMPL.MLT_PRL_ALT_BUSN_KEY AND LAR.COVG_LOB_CLS_ALT_BUSN_KEY = COALESCE(LKP_DIM_CLC.COVG_LOB_CLS_ALT_BUSN_KEY, -1) AND LAR.INSR_ALT_BUSN_KEY = LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.EXC_ALT_BUSN_KEY = LKP_DIM_DEXC.EXC_ALT_BUSN_KEY AND LAR.RETRO_RATG_ALT_BUSN_KEY = LKP_DIM_DRR.RETRO_RATG_ALT_BUSN_KEY AND LAR.SUSP_IND = WIGFI.SUSP_IND AND LAR.FINC_INSR_ALT_BUSN_KEY = H_LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.FINC_COVG_LOB_ALT_BUSN_KEY = H_LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LAR.FINC_PREM_ST_ALT_BUSN_KEY = H_LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.RETRO_CEDE_IND = WIGFI.RETRO_CEDE_IND) /* --------- END QUERY --------------- */ UNION ALL SELECT NEXTVAL('$$DBOwnerWRK.dbaall.SEQ_WORK_INT_FFPL_FI_PK') AS WORK_INT_FFPL_PK, WIGFI.ACC_EXPO_YR_MM AS ACC_EXPO_YR_MM, WIGFI.ASSM_REINS_AGMT_ANCHR_ID AS ASSM_REINS_AGMT_ANCHR_ID, WIGFI.BIL_TYP_CD AS BIL_TYP_CD, WIGFI.BULK_TRAN_IND AS BULK_TRAN_IND, WIGFI.CLS_CD AS CLS_CD, WIGFI.CEDE_REINS_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, WIGFI.CML_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, WIGFI.CMTN_AGMT_ANCHR_ID AS CMTN_AGMT_ANCHR_ID, WIGFI.CRCY_CD AS CRCY_CD, WIGFI.DAC_CD AS DAC_CD, WIGFI.EXC_CD AS EXC_CD, WIGFI.FIN_ACC_EXPO_YR_MM AS FIN_ACC_EXPO_YR_MM, WIGFI.FIN_CYC_PST_DT AS FIN_CYC_PST_DT, WIGFI.FIN_PST_YR_MM AS FIN_PST_YR_MM, WIGFI.LOB_ZA_GP_CD AS LOB_ZA_GP_CD, WIGFI.MP_CD AS MP_CD, WIGFI.OPERT_CO_CD AS OPERT_CO_CD, WIGFI.RETRO_RATG_CD AS RETRO_RATG_CD, CASE WHEN ISDATE(WIGFI.SRC_POL_EFF_DT, 'YYYYMMDD') = 'true' THEN WIGFI.SRC_POL_EFF_DT WHEN LENGTH(TRIM(WIGFI.SRC_POL_EFF_DT)) = 4 AND ISDATE(WIGFI.SRC_POL_EFF_DT || '0101', 'YYYYMMDD') = 'true' THEN TRIM(WIGFI.SRC_POL_EFF_DT) || '0101' ELSE CAST(LKP_CML_AGMT.POL_EFF_DT AS CHAR) END AS SRC_POL_EFF_DT /* ,WIGFI.SRC_POL_EFF_DT */, WIGFI.SUSP_IND AS SUSP_IND, WIGFI.ST_NBR AS ST_NBR, WIGFI.CMTN_IND AS CMTN_IND, WIGFI.ACTL_LOS_RCVY_IDM_AMT AS ACTL_LOS_RCVY_IDM_AMT, WIGFI.ADJR_ALAE_AMT AS ADJR_ALAE_AMT, WIGFI.ANTCP_LOS_RCVY_IDM_AMT AS ANTCP_LOS_RCVY_IDM_AMT, WIGFI.BASE_ADMIN_FEE_AMT AS BASE_ADMIN_FEE_AMT, WIGFI.BASE_PREM_AMT AS BASE_PREM_AMT, WIGFI.CEDE_FEE_AMT AS CEDE_FEE_AMT, WIGFI.CONTR_CAN_PAID_FEE_AMT AS CONTR_CAN_PAID_FEE_AMT, WIGFI.CONTR_TRNSFR_FEE_AMT AS CONTR_TRNSFR_FEE_AMT, WIGFI.DELR_MRKP_AMT AS DELR_MRKP_AMT, WIGFI.DRCVY_ALAE_AMT AS DRCVY_ALAE_AMT, WIGFI.DRCVY_IDM_LOS_AMT AS DRCVY_IDM_LOS_AMT, WIGFI.DRCVY_RSV_ALAE_AMT AS DRCVY_RSV_ALAE_AMT, WIGFI.DRCVY_RSV_IDM_AMT AS DRCVY_RSV_IDM_AMT, WIGFI.EXCS_TAX_AMT AS EXCS_TAX_AMT, WIGFI.LOSS_FUND_AMT AS LOSS_FUND_AMT, WIGFI.LOSS_STBLZ_FEE_AMT AS LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_BASE_ADMIN_FEE_AMT AS MGMT_ERND_BASE_ADMIN_FEE_AMT, WIGFI.MGMT_ERND_BASE_PREM_AMT AS MGMT_ERND_BASE_PREM_AMT, WIGFI.MGMT_ERND_CHRGCUSTCAN_AMT AS MGMT_ERND_CHRGCUSTCAN_AMT, WIGFI.MGMT_ERND_CONTR_TRNSFR_FEE_AMT AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, WIGFI.MGMT_ERND_DELR_MRKP_AMT AS MGMT_ERND_DELR_MRKP_AMT, WIGFI.MGMT_ERND_LOSS_FUND_AMT AS MGMT_ERND_LOSS_FUND_AMT, WIGFI.MGMT_ERND_LOSS_STBLZ_FEE_AMT AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_MISC_PREM_AMT AS MGMT_ERND_MISC_PREM_AMT, WIGFI.MGMT_ERND_NO_CHRGBCK_FEE_AMT AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_ADV_FEE_AMT AS MGMT_ERND_NONRFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_PROMO_FEE AS MGMT_ERND_NONRFND_PROMO_FEE, WIGFI.MGMT_ERND_OVER_RMT_FEE_AMT AS MGMT_ERND_OVER_RMT_FEE_AMT, WIGFI.MGMT_ERND_PRTNR_COMM_FEE_AMT AS MGMT_ERND_PRTNR_COMM_FEE_AMT, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_1 AS MGMT_ERND_SCS_PREM_COMM_AMT_1, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_2 AS MGMT_ERND_SCS_PREM_COMM_AMT_2, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_3 AS MGMT_ERND_SCS_PREM_COMM_AMT_3, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_4 AS MGMT_ERND_SCS_PREM_COMM_AMT_4, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_5 AS MGMT_ERND_SCS_PREM_COMM_AMT_5, WIGFI.MGMT_ERND_RETRO_FEE_AMT AS MGMT_ERND_RETRO_FEE_AMT, WIGFI.MGMT_ERND_RFND_ADV_FEE_AMT AS MGMT_ERND_RFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_RFND_PROMO_FEE_AMT AS MGMT_ERND_RFND_PROMO_FEE_AMT, WIGFI.MGMT_ERND_SURTY_PREM_AMT AS MGMT_ERND_SURTY_PREM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_COMM_AMT AS MGMT_ERND_VOLM_DISC_COMM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_PREM_AMT AS MGMT_ERND_VOLM_DISC_PREM_AMT, WIGFI.MISC_PREM_AMT AS MISC_PREM_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PALAE_AMT AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PIDM_AMT AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_ALAE_AMT AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_IDM_AMT AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, WIGFI.NO_CHRGBCK_FEE_AMT AS NO_CHRGBCK_FEE_AMT, WIGFI.NONRFND_ADV_FEE_AMT AS NONRFND_ADV_FEE_AMT, WIGFI.NONRFND_PROMO_FEE_AMT AS NONRFND_PROMO_FEE_AMT, WIGFI.OVER_RMT_FEE_AMT AS OVER_RMT_FEE_AMT, WIGFI.POOL_IBNR_CHG_AMT AS POOL_IBNR_CHG_AMT, WIGFI.PRTNR_COMM_FEE_AMT AS PRTNR_COMM_FEE_AMT, WIGFI.SCS_PREM_COMM_AMT_1 AS SCS_PREM_COMM_AMT_1, WIGFI.SCS_PREM_COMM_AMT_2 AS SCS_PREM_COMM_AMT_2, WIGFI.SCS_PREM_COMM_AMT_3 AS SCS_PREM_COMM_AMT_3, WIGFI.SCS_PREM_COMM_AMT_4 AS SCS_PREM_COMM_AMT_4, WIGFI.SCS_PREM_COMM_AMT_5 AS SCS_PREM_COMM_AMT_5, WIGFI.RETRO_FEE_AMT AS RETRO_FEE_AMT, WIGFI.RFND_ADV_FEE_AMT AS RFND_ADV_FEE_AMT, WIGFI.RFND_PROMO_FEE_AMT AS RFND_PROMO_FEE_AMT, WIGFI.SLVG_AND_SUBRO_ALAE_AMT AS SLVG_AND_SUBRO_ALAE_AMT, WIGFI.SLVG_AND_SUBRO_IDM_AMT AS SLVG_AND_SUBRO_IDM_AMT, WIGFI.STATU_ERND_BASE_ADMIN_FEE_AMT AS STATU_ERND_BASE_ADMIN_FEE_AMT, WIGFI.STATU_ERND_BASE_PREM_AMT AS STATU_ERND_BASE_PREM_AMT, WIGFI.STATU_ERND_CHRGCUSTCAN_AMT AS STATU_ERND_CHRGCUSTCAN_AMT, WIGFI.STATU_ERND_DELR_MRKP_AMT AS STATU_ERND_DELR_MRKP_AMT, WIGFI.STATU_ERND_LOSS_FUND_AMT AS STATU_ERND_LOSS_FUND_AMT, WIGFI.STATU_ERND_LOSS_STBLZ_FEE_AMT AS STATU_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.STATU_ERND_MISC_PREM_AMT AS STATU_ERND_MISC_PREM_AMT, WIGFI.STATU_ERND_NO_CHRGBCK_FEE_AMT AS STATU_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.STATU_ERND_NONRFND_ADV_FEE_AMT AS STATU_ERND_NONRFND_ADV_FEE_AMT, WIGFI.STATU_ERND_NONRFND_PROMO_FEE AS STATU_ERND_NONRFND_PROMO_FEE, WIGFI.STATU_ERND_OVER_RMT_FEE_AMT AS STATU_ERND_OVER_RMT_FEE_AMT, WIGFI.STATU_ERND_PRTNR_COMM_FEE_AMT AS STATU_ERND_PRTNR_COMM_FEE_AMT, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_1 AS STATU_ERND_SCS_PREM_COMM_AMT_1, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_2 AS STATU_ERND_SCS_PREM_COMM_AMT_2, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_3 AS STATU_ERND_SCS_PREM_COMM_AMT_3, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_4 AS STATU_ERND_SCS_PREM_COMM_AMT_4, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_5 AS STATU_ERND_SCS_PREM_COMM_AMT_5, WIGFI.STATU_ERND_RETRO_FEE_AMT AS STATU_ERND_RETRO_FEE_AMT, WIGFI.STATU_ERND_RFND_ADV_FEE_AMT AS STATU_ERND_RFND_ADV_FEE_AMT, WIGFI.STATU_ERND_RFND_PROMO_FEE_AMT AS STATU_ERND_RFND_PROMO_FEE_AMT, WIGFI.STATU_ERND_SURTY_PREM_AMT AS STATU_ERND_SURTY_PREM_AMT, WIGFI.STATU_ERND_VOLM_DISC_COMM_AMT AS STATU_ERND_VOLM_DISC_COMM_AMT, WIGFI.STATU_ERND_VOLM_DISC_PREM_AMT AS STATU_ERND_VOLM_DISC_PREM_AMT, WIGFI.SURTY_PREM_AMT AS SURTY_PREM_AMT, WIGFI.ULAE_AMT AS ULAE_AMT, WIGFI.VOLM_DISC_COMM_AMT AS VOLM_DISC_COMM_AMT, WIGFI.VOLM_DISC_PREM_AMT AS VOLM_DISC_PREM_AMT, WIGFI.PREM_TAX_AMT AS PREM_TAX_AMT, WIGFI.ASSET_DEF_FEE_AMT AS ASSET_DEF_FEE_AMT, WIGFI.CTRY_CD AS CTRY_CD, WIGFI.RETRO_CEDE_IND AS RETRO_CEDE_IND, WIGFI.SYS_PRCG_CD AS SYS_PRCG_CD, WIGFI.MGMT_CEDE_FEE_AMT AS MGMT_CEDE_FEE_AMT, WIGFI.MGMT_EXCS_TAX_AMT AS MGMT_EXCS_TAX_AMT, WIGFI.MGMT_PREM_TAX_AMT AS MGMT_PREM_TAX_AMT, WIGFI.STATU_CEDE_FEE_AMT AS STATU_CEDE_FEE_AMT, WIGFI.STATU_ERND_CONTRTRNSFR_FEE_AMT AS STATU_ERND_CONTRTRNSFR_FEE_AMT, WIGFI.STATU_EXCS_TAX_AMT AS STATU_EXCS_TAX_AMT, WIGFI.STATU_PREM_TAX_AMT AS STATU_PREM_TAX_AMT, COALESCE(LKP_BIL_TYPE.BIL_TYP_ALT_BUSN_KEY, -1), COALESCE(LKP_CTRY_CD.CTRY_ALT_BUSN_KEY, -1), COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS LOCAL_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS TRAN_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS CONTR_CRCY_ALT_BUSN_KEY, COALESCE(LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY, -1), COALESCE(LAR.ACTU_AND_FINC_DERVN_ALT_BUSN_KEY, -1), CAST('2999-12-31' AS DATE) AS EFF_TO_TISTMP, WIGFI.STAT_COMM_AMT AS STAT_COMM_AMT, WIGFI.DRVD_FINC_LOS_CATG_CD AS DRVD_FINC_LOS_CATG_CD, WIGFI.CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */ AS CLAIM_LOSS_ADJ_CHARGE_AMT, NOW() AS EFF_FRM_TISTMP FROM (SELECT ACC_EXPO_YR_MM AS WORK_INT_FFPL_PK, ASSM_REINS_AGMT_ANCHR_ID AS ACC_EXPO_YR_MM, BIL_TYP_CD AS ASSM_REINS_AGMT_ANCHR_ID, BULK_TRAN_IND AS BIL_TYP_CD, CLS_CD AS BULK_TRAN_IND, CEDE_REINS_AGMT_ANCHR_ID AS CLS_CD, CML_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, CRCY_CD AS CMTN_AGMT_ANCHR_ID, DAC_CD AS CRCY_CD, EXC_CD AS DAC_CD, FIN_ACC_EXPO_YR_MM AS EXC_CD, FIN_CYC_PST_DT AS FIN_ACC_EXPO_YR_MM, FIN_PST_YR_MM AS FIN_CYC_PST_DT, LOB_ZA_GP_CD AS FIN_PST_YR_MM, MP_CD AS LOB_ZA_GP_CD, OPERT_CO_CD AS MP_CD, RETRO_RATG_CD AS OPERT_CO_CD, SRC_POL_EFF_DT AS RETRO_RATG_CD, SUSP_IND AS SRC_POL_EFF_DT, ST_NBR AS SUSP_IND, CMTN_IND AS ST_NBR, SUM(ACTL_LOS_RCVY_IDM_AMT) AS CMTN_IND, SUM(ADJR_ALAE_AMT) AS ACTL_LOS_RCVY_IDM_AMT, SUM(ANTCP_LOS_RCVY_IDM_AMT) AS ADJR_ALAE_AMT, SUM(BASE_ADMIN_FEE_AMT) AS ANTCP_LOS_RCVY_IDM_AMT, SUM(BASE_PREM_AMT) AS BASE_ADMIN_FEE_AMT, SUM(CEDE_FEE_AMT) AS BASE_PREM_AMT, SUM(CONTR_CAN_PAID_FEE_AMT) AS CEDE_FEE_AMT, SUM(CONTR_TRNSFR_FEE_AMT) AS CONTR_CAN_PAID_FEE_AMT, SUM(DELR_MRKP_AMT) AS CONTR_TRNSFR_FEE_AMT, SUM(DRCVY_ALAE_AMT) AS DELR_MRKP_AMT, SUM(DRCVY_IDM_LOS_AMT) AS DRCVY_ALAE_AMT, SUM(DRCVY_RSV_ALAE_AMT) AS DRCVY_IDM_LOS_AMT, SUM(DRCVY_RSV_IDM_AMT) AS DRCVY_RSV_ALAE_AMT, SUM(EXCS_TAX_AMT) AS DRCVY_RSV_IDM_AMT, SUM(LOSS_FUND_AMT) AS EXCS_TAX_AMT, SUM(LOSS_STBLZ_FEE_AMT) AS LOSS_FUND_AMT, SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) AS LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_BASE_PREM_AMT) AS MGMT_ERND_BASE_ADMIN_FEE_AMT, SUM(MGMT_ERND_CHRGCUSTCAN_AMT) AS MGMT_ERND_BASE_PREM_AMT, SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) AS MGMT_ERND_CHRGCUSTCAN_AMT, SUM(MGMT_ERND_DELR_MRKP_AMT) AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, SUM(MGMT_ERND_LOSS_FUND_AMT) AS MGMT_ERND_DELR_MRKP_AMT, SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) AS MGMT_ERND_LOSS_FUND_AMT, SUM(MGMT_ERND_MISC_PREM_AMT) AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) AS MGMT_ERND_MISC_PREM_AMT, SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, SUM(MGMT_ERND_NONRFND_PROMO_FEE) AS MGMT_ERND_NONRFND_ADV_FEE_AMT, SUM(MGMT_ERND_OVER_RMT_FEE_AMT) AS MGMT_ERND_NONRFND_PROMO_FEE, SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) AS MGMT_ERND_OVER_RMT_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) AS MGMT_ERND_PRTNR_COMM_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) AS MGMT_ERND_SCS_PREM_COMM_AMT_1, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) AS MGMT_ERND_SCS_PREM_COMM_AMT_2, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) AS MGMT_ERND_SCS_PREM_COMM_AMT_3, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) AS MGMT_ERND_SCS_PREM_COMM_AMT_4, SUM(MGMT_ERND_RETRO_FEE_AMT) AS MGMT_ERND_SCS_PREM_COMM_AMT_5, SUM(MGMT_ERND_RFND_ADV_FEE_AMT) AS MGMT_ERND_RETRO_FEE_AMT, SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) AS MGMT_ERND_RFND_ADV_FEE_AMT, SUM(MGMT_ERND_SURTY_PREM_AMT) AS MGMT_ERND_RFND_PROMO_FEE_AMT, SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) AS MGMT_ERND_SURTY_PREM_AMT, SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_COMM_AMT, SUM(MISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) AS MISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, SUM(NO_CHRGBCK_FEE_AMT) AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, SUM(NONRFND_ADV_FEE_AMT) AS NO_CHRGBCK_FEE_AMT, SUM(NONRFND_PROMO_FEE_AMT) AS NONRFND_ADV_FEE_AMT, SUM(OVER_RMT_FEE_AMT) AS NONRFND_PROMO_FEE_AMT, SUM(POOL_IBNR_CHG_AMT) AS OVER_RMT_FEE_AMT, SUM(PRTNR_COMM_FEE_AMT) AS POOL_IBNR_CHG_AMT, SUM(SCS_PREM_COMM_AMT_1) AS PRTNR_COMM_FEE_AMT, SUM(SCS_PREM_COMM_AMT_2) AS SCS_PREM_COMM_AMT_1, SUM(SCS_PREM_COMM_AMT_3) AS SCS_PREM_COMM_AMT_2, SUM(SCS_PREM_COMM_AMT_4) AS SCS_PREM_COMM_AMT_3, SUM(SCS_PREM_COMM_AMT_5) AS SCS_PREM_COMM_AMT_4, SUM(RETRO_FEE_AMT) AS SCS_PREM_COMM_AMT_5, SUM(RFND_ADV_FEE_AMT) AS RETRO_FEE_AMT, SUM(RFND_PROMO_FEE_AMT) AS RFND_ADV_FEE_AMT, SUM(SLVG_AND_SUBRO_ALAE_AMT) AS RFND_PROMO_FEE_AMT, SUM(SLVG_AND_SUBRO_IDM_AMT) AS SLVG_AND_SUBRO_ALAE_AMT, SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) AS SLVG_AND_SUBRO_IDM_AMT, SUM(STATU_ERND_BASE_PREM_AMT) AS STATU_ERND_BASE_ADMIN_FEE_AMT, SUM(STATU_ERND_CHRGCUSTCAN_AMT) AS STATU_ERND_BASE_PREM_AMT, SUM(STATU_ERND_DELR_MRKP_AMT) AS STATU_ERND_CHRGCUSTCAN_AMT, SUM(STATU_ERND_LOSS_FUND_AMT) AS STATU_ERND_DELR_MRKP_AMT, SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) AS STATU_ERND_LOSS_FUND_AMT, SUM(STATU_ERND_MISC_PREM_AMT) AS STATU_ERND_LOSS_STBLZ_FEE_AMT, SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) AS STATU_ERND_MISC_PREM_AMT, SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) AS STATU_ERND_NO_CHRGBCK_FEE_AMT, SUM(STATU_ERND_NONRFND_PROMO_FEE) AS STATU_ERND_NONRFND_ADV_FEE_AMT, SUM(STATU_ERND_OVER_RMT_FEE_AMT) AS STATU_ERND_NONRFND_PROMO_FEE, SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) AS STATU_ERND_OVER_RMT_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) AS STATU_ERND_PRTNR_COMM_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) AS STATU_ERND_SCS_PREM_COMM_AMT_1, SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) AS STATU_ERND_SCS_PREM_COMM_AMT_2, SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) AS STATU_ERND_SCS_PREM_COMM_AMT_3, SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) AS STATU_ERND_SCS_PREM_COMM_AMT_4, SUM(STATU_ERND_RETRO_FEE_AMT) AS STATU_ERND_SCS_PREM_COMM_AMT_5, SUM(STATU_ERND_RFND_ADV_FEE_AMT) AS STATU_ERND_RETRO_FEE_AMT, SUM(STATU_ERND_RFND_PROMO_FEE_AMT) AS STATU_ERND_RFND_ADV_FEE_AMT, SUM(STATU_ERND_SURTY_PREM_AMT) AS STATU_ERND_RFND_PROMO_FEE_AMT, SUM(STATU_ERND_VOLM_DISC_COMM_AMT) AS STATU_ERND_SURTY_PREM_AMT, SUM(STATU_ERND_VOLM_DISC_PREM_AMT) AS STATU_ERND_VOLM_DISC_COMM_AMT, SUM(SURTY_PREM_AMT) AS STATU_ERND_VOLM_DISC_PREM_AMT, SUM(ULAE_AMT) AS SURTY_PREM_AMT, SUM(VOLM_DISC_COMM_AMT) AS ULAE_AMT, SUM(VOLM_DISC_PREM_AMT) AS VOLM_DISC_COMM_AMT, SUM(PREM_TAX_AMT) AS VOLM_DISC_PREM_AMT, SUM(ASSET_DEF_FEE_AMT) AS PREM_TAX_AMT, CTRY_CD AS ASSET_DEF_FEE_AMT, RETRO_CEDE_IND AS CTRY_CD, SYS_PRCG_CD AS RETRO_CEDE_IND, SUM(MGMT_CEDE_FEE_AMT) AS SYS_PRCG_CD, SUM(MGMT_EXCS_TAX_AMT) AS MGMT_CEDE_FEE_AMT, SUM(MGMT_PREM_TAX_AMT) AS MGMT_EXCS_TAX_AMT, SUM(STATU_CEDE_FEE_AMT) AS MGMT_PREM_TAX_AMT, SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) AS STATU_CEDE_FEE_AMT, SUM(STATU_EXCS_TAX_AMT) AS STATU_ERND_CONTRTRNSFR_FEE_AMT, SUM(STATU_PREM_TAX_AMT) AS STATU_EXCS_TAX_AMT, SUM(STAT_COMM_AMT) AS STATU_PREM_TAX_AMT, DRVD_FINC_LOS_CATG_CD AS BIL_TYP_ALT_BUSN_KEY, SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) AS CTRY_ALT_BUSN_KEY /* CR79 */ FROM work_init_gpng_finc_ins WHERE CML_AGMT_ANCHR_ID % 4 = 2 GROUP BY (ACC_EXPO_YR_MM, ASSM_REINS_AGMT_ANCHR_ID, BIL_TYP_CD, BULK_TRAN_IND, CLS_CD, CEDE_REINS_AGMT_ANCHR_ID, CML_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID, CRCY_CD, DAC_CD, EXC_CD, FIN_ACC_EXPO_YR_MM, FIN_CYC_PST_DT, FIN_PST_YR_MM, LOB_ZA_GP_CD, MP_CD, OPERT_CO_CD, RETRO_RATG_CD, SRC_POL_EFF_DT, SUSP_IND, ST_NBR, CMTN_IND, CTRY_CD, RETRO_CEDE_IND, SYS_PRCG_CD, DRVD_FINC_LOS_CATG_CD, CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */) HAVING SUM(ACTL_LOS_RCVY_IDM_AMT) <> 0 OR SUM(ADJR_ALAE_AMT) <> 0 OR SUM(ANTCP_LOS_RCVY_IDM_AMT) <> 0 OR SUM(BASE_ADMIN_FEE_AMT) <> 0 OR SUM(BASE_PREM_AMT) <> 0 OR SUM(CEDE_FEE_AMT) <> 0 OR SUM(CONTR_CAN_PAID_FEE_AMT) <> 0 OR SUM(CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(DELR_MRKP_AMT) <> 0 OR SUM(DRCVY_ALAE_AMT) <> 0 OR SUM(DRCVY_IDM_LOS_AMT) <> 0 OR SUM(DRCVY_RSV_ALAE_AMT) <> 0 OR SUM(DRCVY_RSV_IDM_AMT) <> 0 OR SUM(EXCS_TAX_AMT) <> 0 OR SUM(LOSS_FUND_AMT) <> 0 OR SUM(LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_PREM_AMT) <> 0 OR SUM(MGMT_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(MGMT_ERND_DELR_MRKP_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_FUND_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_MISC_PREM_AMT) <> 0 OR SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(MGMT_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(MGMT_ERND_RETRO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SURTY_PREM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(MISC_PREM_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) <> 0 OR SUM(NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(NONRFND_ADV_FEE_AMT) <> 0 OR SUM(NONRFND_PROMO_FEE_AMT) <> 0 OR SUM(OVER_RMT_FEE_AMT) <> 0 OR SUM(POOL_IBNR_CHG_AMT) <> 0 OR SUM(PRTNR_COMM_FEE_AMT) <> 0 OR SUM(SCS_PREM_COMM_AMT_1) <> 0 OR SUM(SCS_PREM_COMM_AMT_2) <> 0 OR SUM(SCS_PREM_COMM_AMT_3) <> 0 OR SUM(SCS_PREM_COMM_AMT_4) <> 0 OR SUM(SCS_PREM_COMM_AMT_5) <> 0 OR SUM(RETRO_FEE_AMT) <> 0 OR SUM(RFND_ADV_FEE_AMT) <> 0 OR SUM(RFND_PROMO_FEE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_ALAE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_IDM_AMT) <> 0 OR SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(STATU_ERND_BASE_PREM_AMT) <> 0 OR SUM(STATU_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(STATU_ERND_DELR_MRKP_AMT) <> 0 OR SUM(STATU_ERND_LOSS_FUND_AMT) <> 0 OR SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(STATU_ERND_MISC_PREM_AMT) <> 0 OR SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(STATU_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(STATU_ERND_RETRO_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(STATU_ERND_SURTY_PREM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(SURTY_PREM_AMT) <> 0 OR SUM(ULAE_AMT) <> 0 OR SUM(VOLM_DISC_COMM_AMT) <> 0 OR SUM(VOLM_DISC_PREM_AMT) <> 0 OR SUM(PREM_TAX_AMT) <> 0 OR SUM(ASSET_DEF_FEE_AMT) <> 0 OR SUM(MGMT_CEDE_FEE_AMT) <> 0 OR SUM(MGMT_EXCS_TAX_AMT) <> 0 OR SUM(MGMT_PREM_TAX_AMT) <> 0 OR SUM(STATU_CEDE_FEE_AMT) <> 0 OR SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) <> 0 OR SUM(STATU_EXCS_TAX_AMT) <> 0 OR SUM(STATU_PREM_TAX_AMT) <> 0 OR SUM(STAT_COMM_AMT) <> 0 OR SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) <> 0 /* CR79 */) AS WIGFI INNER JOIN lkup_prem_postal_regn_co AS LPPRC ON (WIGFI.OPERT_CO_CD = LPPRC.OPERT_CO_CD AND WIGFI.ST_NBR = LPPRC.PREM_POSTAL_REGN_CD AND WIGFI.FIN_PST_YR_MM >= LPPRC.EFF_FM_CCYYMM AND WIGFI.FIN_PST_YR_MM <= LPPRC.EFF_TO_CCYYMM) LEFT OUTER JOIN cml_agmt AS LKP_CML_AGMT ON (LKP_CML_AGMT.AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_CML_AGMT.ACTV_REC_IND = 'Y') /*
LEFT OUTER JOIN work_prcg_cyc_dt WPCD 
ON WPCD.ACTV_REC_IND = 'Y' And WPCD.TYP_ID = 79
*/ LEFT OUTER JOIN dim_bil_typ_late_actv AS LKP_BIL_TYPE ON (LKP_BIL_TYPE.BIL_TYP_CD = CASE WHEN RTRIM(WIGFI.BIL_TYP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.BIL_TYP_CD) END AND LKP_BIL_TYPE.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ctry AS LKP_CTRY_CD ON (LKP_CTRY_CD.CTRY_NBR = CASE WHEN RTRIM(WIGFI.CTRY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CTRY_CD) END AND LKP_CTRY_CD.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_crcy AS LKP_LOCAL_CRCY ON (LKP_LOCAL_CRCY.CRCY_CD = CASE WHEN RTRIM(WIGFI.CRCY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CRCY_CD) END AND LKP_LOCAL_CRCY.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN ON (LKP_DIM_REIN.REINS_AGMT_ANCHR_ID = WIGFI.ASSM_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN1 ON (LKP_DIM_REIN1.REINS_AGMT_ANCHR_ID = WIGFI.CEDE_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN1.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_cmtn_agmt AS LKP_DIM_CMTN ON (LKP_DIM_CMTN.CMTN_AGMT_ANCHR_ID = WIGFI.CMTN_AGMT_ANCHR_ID AND LKP_DIM_CMTN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ins_pol_and_rlup_late_actv_mm AS LKP_DIM_DIPR ON (LKP_DIM_DIPR.CML_AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_DIM_DIPR.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob AS LKP_DIM_DCL ON (LKP_DIM_DCL.ZA_COVG_CD = CASE WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.LOB_ZA_GP_CD) END AND LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS LKP_DIM_ST ON (LKP_DIM_ST.ST_NBR = CASE WHEN RTRIM(WIGFI.ST_NBR) = '' THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.ST_NBR) END AND LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_dir_assm_cede AS LKP_DIM_DDAC ON (LKP_DIM_DDAC.DIR_ASSM_CEDE_CD = CASE WHEN RTRIM(WIGFI.DAC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.DAC_CD) END AND LKP_DIM_DDAC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_mlt_prl AS LKP_DIM_DMPL ON (LKP_DIM_DMPL.MLT_PRL_CD = CASE WHEN RTRIM(WIGFI.MP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.MP_CD) END AND LKP_DIM_DMPL.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob_cls_late_actv AS LKP_DIM_CLC ON (LKP_DIM_CLC.CLS_CD = CASE WHEN RTRIM(WIGFI.CLS_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CLS_CD) END AND LKP_DIM_CLC.COVG_LOB_ALT_BUSN_KEY = LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LKP_DIM_CLC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS LKP_DIM_DINS ON (LKP_DIM_DINS.OPERT_CO_CD = CASE WHEN RTRIM(WIGFI.OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.OPERT_CO_CD) END AND LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_exc_late_actv AS LKP_DIM_DEXC ON (LKP_DIM_DEXC.EXC_CD = CASE WHEN RTRIM(WIGFI.EXC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.EXC_CD) END AND LKP_DIM_DEXC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_retro_ratg_late_actv AS LKP_DIM_DRR ON (LKP_DIM_DRR.RETRO_RATG_CD = CASE WHEN RTRIM(WIGFI.RETRO_RATG_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.RETRO_RATG_CD) END AND LKP_DIM_DRR.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS H_LKP_DIM_DINS ON (RTRIM(H_LKP_DIM_DINS.OPERT_CO_CD) = CASE WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_OPERT_CO_CD) END AND H_LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS H_LKP_DIM_ST ON (RTRIM(H_LKP_DIM_ST.ST_NBR) = CASE WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) END AND H_LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT JOIN work_actu_and_fin_pol AS AFP ON LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY = AFP.INS_POL_AND_RLUP_ALT_BUSN_KEY AND AFP.LATE_ACTV_REC_IND = 'Y' LEFT JOIN (SELECT DISTINCT LOB_ZA_GP_CD AS WORK_INT_FFPL_PK, ETL_IND AS ACC_EXPO_YR_MM FROM dim_lob_za_gp_cd AS lkp_src) AS DLZ ON DLZ.LOB_ZA_GP_CD = RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) AND ETL_IND = 'N' /* DLZ.LOB_ZA_GP_CD if it is not null then set as Financial LOB ZA Group Code */ LEFT JOIN work_maj_ln_dflt_asmt AS MLDA ON MLDA.MAJ_LN_CD = SUBSTR(RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END), 1, 2) /* - SUBSTR(RTRIM(DECODE(rtrim((WIGFI.LOB_ZA_GP_CD)),'','UNK',NULL,'UNK','null','UNK',WIGFI.LOB_ZA_GP_CD)),1,2) || MLDA.SUB_LN_CD || MLDA.COVG_CD THIS WILL BE APPLY WHEN IN ABOCE FINC CODE IS NULL */ LEFT JOIN cd ON CD.CD_VAL = AFP.POL_SYM_CD AND CD.CD_SCM = 'POLICY_SYMBOL_F&I' AND CD.ACTV_REC_IND = 'Y' /* THEN SET FINC_LOB_ZA_GP_CD ='526001' */ LEFT JOIN (SELECT OPERT_CO_CD AS WORK_INT_FFPL_PK FROM extl_org AS EO, $$DBOwnerATM.dbaall.EXTL_ORG_DTL AS EOD WHERE EO.TYP_ID = 26 AND EO.ROL_PLYR_ANCHR_ID = EOD.ROL_PLYR_ANCHR_ID AND EO.ACTV_REC_IND = 'Y' AND EOD.ACTV_REC_IND = 'Y' AND EOD.DOMCL_LOC_CD = 'CAN') AS ABC ON ABC.OPERT_CO_CD = AFP.OPERT_CO_CD LEFT OUTER JOIN dim_covg_lob AS H_LKP_DIM_DCL ON (RTRIM(H_LKP_DIM_DCL.ZA_COVG_CD) = CASE WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = '' THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) IS NULL THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = 'null' THEN 'UNK' ELSE RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) END AND H_LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN late_active_records AS LAR ON (LAR.ACC_EXPO_YY = SUBSTR(WIGFI.ACC_EXPO_YR_MM, 1, 4) AND LAR.FINC_ACC_EXPO_YY = SUBSTR(WIGFI.FIN_ACC_EXPO_YR_MM, 1, 4) AND LAR.ASSM_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN.REINS_AGMT_ALT_BUSN_KEY AND LAR.CEDE_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN1.REINS_AGMT_ALT_BUSN_KEY AND LAR.CMTN_AGMT_ALT_BUSN_KEY = LKP_DIM_CMTN.CMTN_AGMT_ALT_BUSN_KEY AND LAR.INS_POL_AND_RLUP_ALT_BUSN_KEY = LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY AND LAR.ST_ALT_BUSN_KEY = LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.DIR_ASSM_CEDE_ALT_BUSN_KEY = LKP_DIM_DDAC.DIR_ASSM_CEDE_ALT_BUSN_KEY AND LAR.MLT_PRL_ALT_BUSN_KEY = LKP_DIM_DMPL.MLT_PRL_ALT_BUSN_KEY AND LAR.COVG_LOB_CLS_ALT_BUSN_KEY = COALESCE(LKP_DIM_CLC.COVG_LOB_CLS_ALT_BUSN_KEY, -1) AND LAR.INSR_ALT_BUSN_KEY = LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.EXC_ALT_BUSN_KEY = LKP_DIM_DEXC.EXC_ALT_BUSN_KEY AND LAR.RETRO_RATG_ALT_BUSN_KEY = LKP_DIM_DRR.RETRO_RATG_ALT_BUSN_KEY AND LAR.SUSP_IND = WIGFI.SUSP_IND AND LAR.FINC_INSR_ALT_BUSN_KEY = H_LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.FINC_COVG_LOB_ALT_BUSN_KEY = H_LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LAR.FINC_PREM_ST_ALT_BUSN_KEY = H_LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.RETRO_CEDE_IND = WIGFI.RETRO_CEDE_IND) /* --------- END QUERY --------------- */ UNION ALL /* ------------ START QUERY --------------- */ WITH LATE_ACTIVE_RECORDS AS (SELECT ASSM_REINS_AGMT_ALT_BUSN_KEY AS WORK_INT_FFPL_PK, CEDE_REINS_AGMT_ALT_BUSN_KEY AS ACC_EXPO_YR_MM, CMTN_AGMT_ALT_BUSN_KEY AS ASSM_REINS_AGMT_ANCHR_ID, INS_POL_AND_RLUP_ALT_BUSN_KEY AS BIL_TYP_CD, ST_ALT_BUSN_KEY AS BULK_TRAN_IND, DIR_ASSM_CEDE_ALT_BUSN_KEY AS CLS_CD, MLT_PRL_ALT_BUSN_KEY AS CEDE_REINS_AGMT_ANCHR_ID, COVG_LOB_CLS_ALT_BUSN_KEY AS CML_AGMT_ANCHR_ID, INSR_ALT_BUSN_KEY AS CMTN_AGMT_ANCHR_ID, EXC_ALT_BUSN_KEY AS CRCY_CD, RETRO_RATG_ALT_BUSN_KEY AS DAC_CD, SUSP_IND AS EXC_CD, TYP_INS_CD AS FIN_ACC_EXPO_YR_MM, RETRO_CEDE_IND AS FIN_CYC_PST_DT, ACC_EXPO_YY AS FIN_PST_YR_MM, FINC_ACC_EXPO_YY AS LOB_ZA_GP_CD, LATE_ACTV_REC_IND AS MP_CD, FINC_INSR_ALT_BUSN_KEY AS OPERT_CO_CD, FINC_COVG_LOB_ALT_BUSN_KEY AS RETRO_RATG_CD, FINC_PREM_ST_ALT_BUSN_KEY AS SRC_POL_EFF_DT, ACTU_AND_FINC_DERVN_ALT_BUSN_KEY AS SUSP_IND FROM dim_actu_and_finc_dervn_mm WHERE TYP_INS_CD = 'F&I' AND LATE_ACTV_REC_IND = 'Y') SELECT NEXTVAL('$$DBOwnerWRK.dbaall.SEQ_WORK_INT_FFPL_FI_PK') AS WORK_INT_FFPL_PK, WIGFI.ACC_EXPO_YR_MM AS ACC_EXPO_YR_MM, WIGFI.ASSM_REINS_AGMT_ANCHR_ID AS ASSM_REINS_AGMT_ANCHR_ID, WIGFI.BIL_TYP_CD AS BIL_TYP_CD, WIGFI.BULK_TRAN_IND AS BULK_TRAN_IND, WIGFI.CLS_CD AS CLS_CD, WIGFI.CEDE_REINS_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, WIGFI.CML_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, WIGFI.CMTN_AGMT_ANCHR_ID AS CMTN_AGMT_ANCHR_ID, WIGFI.CRCY_CD AS CRCY_CD, WIGFI.DAC_CD AS DAC_CD, WIGFI.EXC_CD AS EXC_CD, WIGFI.FIN_ACC_EXPO_YR_MM AS FIN_ACC_EXPO_YR_MM, WIGFI.FIN_CYC_PST_DT AS FIN_CYC_PST_DT, WIGFI.FIN_PST_YR_MM AS FIN_PST_YR_MM, WIGFI.LOB_ZA_GP_CD AS LOB_ZA_GP_CD, WIGFI.MP_CD AS MP_CD, WIGFI.OPERT_CO_CD AS OPERT_CO_CD, WIGFI.RETRO_RATG_CD AS RETRO_RATG_CD, CASE WHEN ISDATE(WIGFI.SRC_POL_EFF_DT, 'YYYYMMDD') = 'true' THEN WIGFI.SRC_POL_EFF_DT WHEN LENGTH(TRIM(WIGFI.SRC_POL_EFF_DT)) = 4 AND ISDATE(WIGFI.SRC_POL_EFF_DT || '0101', 'YYYYMMDD') = 'true' THEN TRIM(WIGFI.SRC_POL_EFF_DT) || '0101' ELSE CAST(LKP_CML_AGMT.POL_EFF_DT AS CHAR) END AS SRC_POL_EFF_DT /* -,WIGFI.SRC_POL_EFF_DT */, WIGFI.SUSP_IND AS SUSP_IND, WIGFI.ST_NBR AS ST_NBR, WIGFI.CMTN_IND AS CMTN_IND, WIGFI.ACTL_LOS_RCVY_IDM_AMT AS ACTL_LOS_RCVY_IDM_AMT, WIGFI.ADJR_ALAE_AMT AS ADJR_ALAE_AMT, WIGFI.ANTCP_LOS_RCVY_IDM_AMT AS ANTCP_LOS_RCVY_IDM_AMT, WIGFI.BASE_ADMIN_FEE_AMT AS BASE_ADMIN_FEE_AMT, WIGFI.BASE_PREM_AMT AS BASE_PREM_AMT, WIGFI.CEDE_FEE_AMT AS CEDE_FEE_AMT, WIGFI.CONTR_CAN_PAID_FEE_AMT AS CONTR_CAN_PAID_FEE_AMT, WIGFI.CONTR_TRNSFR_FEE_AMT AS CONTR_TRNSFR_FEE_AMT, WIGFI.DELR_MRKP_AMT AS DELR_MRKP_AMT, WIGFI.DRCVY_ALAE_AMT AS DRCVY_ALAE_AMT, WIGFI.DRCVY_IDM_LOS_AMT AS DRCVY_IDM_LOS_AMT, WIGFI.DRCVY_RSV_ALAE_AMT AS DRCVY_RSV_ALAE_AMT, WIGFI.DRCVY_RSV_IDM_AMT AS DRCVY_RSV_IDM_AMT, WIGFI.EXCS_TAX_AMT AS EXCS_TAX_AMT, WIGFI.LOSS_FUND_AMT AS LOSS_FUND_AMT, WIGFI.LOSS_STBLZ_FEE_AMT AS LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_BASE_ADMIN_FEE_AMT AS MGMT_ERND_BASE_ADMIN_FEE_AMT, WIGFI.MGMT_ERND_BASE_PREM_AMT AS MGMT_ERND_BASE_PREM_AMT, WIGFI.MGMT_ERND_CHRGCUSTCAN_AMT AS MGMT_ERND_CHRGCUSTCAN_AMT, WIGFI.MGMT_ERND_CONTR_TRNSFR_FEE_AMT AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, WIGFI.MGMT_ERND_DELR_MRKP_AMT AS MGMT_ERND_DELR_MRKP_AMT, WIGFI.MGMT_ERND_LOSS_FUND_AMT AS MGMT_ERND_LOSS_FUND_AMT, WIGFI.MGMT_ERND_LOSS_STBLZ_FEE_AMT AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.MGMT_ERND_MISC_PREM_AMT AS MGMT_ERND_MISC_PREM_AMT, WIGFI.MGMT_ERND_NO_CHRGBCK_FEE_AMT AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_ADV_FEE_AMT AS MGMT_ERND_NONRFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_NONRFND_PROMO_FEE AS MGMT_ERND_NONRFND_PROMO_FEE, WIGFI.MGMT_ERND_OVER_RMT_FEE_AMT AS MGMT_ERND_OVER_RMT_FEE_AMT, WIGFI.MGMT_ERND_PRTNR_COMM_FEE_AMT AS MGMT_ERND_PRTNR_COMM_FEE_AMT, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_1 AS MGMT_ERND_SCS_PREM_COMM_AMT_1, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_2 AS MGMT_ERND_SCS_PREM_COMM_AMT_2, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_3 AS MGMT_ERND_SCS_PREM_COMM_AMT_3, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_4 AS MGMT_ERND_SCS_PREM_COMM_AMT_4, WIGFI.MGMT_ERND_SCS_PREM_COMM_AMT_5 AS MGMT_ERND_SCS_PREM_COMM_AMT_5, WIGFI.MGMT_ERND_RETRO_FEE_AMT AS MGMT_ERND_RETRO_FEE_AMT, WIGFI.MGMT_ERND_RFND_ADV_FEE_AMT AS MGMT_ERND_RFND_ADV_FEE_AMT, WIGFI.MGMT_ERND_RFND_PROMO_FEE_AMT AS MGMT_ERND_RFND_PROMO_FEE_AMT, WIGFI.MGMT_ERND_SURTY_PREM_AMT AS MGMT_ERND_SURTY_PREM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_COMM_AMT AS MGMT_ERND_VOLM_DISC_COMM_AMT, WIGFI.MGMT_ERND_VOLM_DISC_PREM_AMT AS MGMT_ERND_VOLM_DISC_PREM_AMT, WIGFI.MISC_PREM_AMT AS MISC_PREM_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PALAE_AMT AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, WIGFI.NET_DRCVY_SLVG_SUBRO_PIDM_AMT AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_ALAE_AMT AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, WIGFI.NET_OF_DRCVY_LOS_RSV_IDM_AMT AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, WIGFI.NO_CHRGBCK_FEE_AMT AS NO_CHRGBCK_FEE_AMT, WIGFI.NONRFND_ADV_FEE_AMT AS NONRFND_ADV_FEE_AMT, WIGFI.NONRFND_PROMO_FEE_AMT AS NONRFND_PROMO_FEE_AMT, WIGFI.OVER_RMT_FEE_AMT AS OVER_RMT_FEE_AMT, WIGFI.POOL_IBNR_CHG_AMT AS POOL_IBNR_CHG_AMT, WIGFI.PRTNR_COMM_FEE_AMT AS PRTNR_COMM_FEE_AMT, WIGFI.SCS_PREM_COMM_AMT_1 AS SCS_PREM_COMM_AMT_1, WIGFI.SCS_PREM_COMM_AMT_2 AS SCS_PREM_COMM_AMT_2, WIGFI.SCS_PREM_COMM_AMT_3 AS SCS_PREM_COMM_AMT_3, WIGFI.SCS_PREM_COMM_AMT_4 AS SCS_PREM_COMM_AMT_4, WIGFI.SCS_PREM_COMM_AMT_5 AS SCS_PREM_COMM_AMT_5, WIGFI.RETRO_FEE_AMT AS RETRO_FEE_AMT, WIGFI.RFND_ADV_FEE_AMT AS RFND_ADV_FEE_AMT, WIGFI.RFND_PROMO_FEE_AMT AS RFND_PROMO_FEE_AMT, WIGFI.SLVG_AND_SUBRO_ALAE_AMT AS SLVG_AND_SUBRO_ALAE_AMT, WIGFI.SLVG_AND_SUBRO_IDM_AMT AS SLVG_AND_SUBRO_IDM_AMT, WIGFI.STATU_ERND_BASE_ADMIN_FEE_AMT AS STATU_ERND_BASE_ADMIN_FEE_AMT, WIGFI.STATU_ERND_BASE_PREM_AMT AS STATU_ERND_BASE_PREM_AMT, WIGFI.STATU_ERND_CHRGCUSTCAN_AMT AS STATU_ERND_CHRGCUSTCAN_AMT, WIGFI.STATU_ERND_DELR_MRKP_AMT AS STATU_ERND_DELR_MRKP_AMT, WIGFI.STATU_ERND_LOSS_FUND_AMT AS STATU_ERND_LOSS_FUND_AMT, WIGFI.STATU_ERND_LOSS_STBLZ_FEE_AMT AS STATU_ERND_LOSS_STBLZ_FEE_AMT, WIGFI.STATU_ERND_MISC_PREM_AMT AS STATU_ERND_MISC_PREM_AMT, WIGFI.STATU_ERND_NO_CHRGBCK_FEE_AMT AS STATU_ERND_NO_CHRGBCK_FEE_AMT, WIGFI.STATU_ERND_NONRFND_ADV_FEE_AMT AS STATU_ERND_NONRFND_ADV_FEE_AMT, WIGFI.STATU_ERND_NONRFND_PROMO_FEE AS STATU_ERND_NONRFND_PROMO_FEE, WIGFI.STATU_ERND_OVER_RMT_FEE_AMT AS STATU_ERND_OVER_RMT_FEE_AMT, WIGFI.STATU_ERND_PRTNR_COMM_FEE_AMT AS STATU_ERND_PRTNR_COMM_FEE_AMT, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_1 AS STATU_ERND_SCS_PREM_COMM_AMT_1, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_2 AS STATU_ERND_SCS_PREM_COMM_AMT_2, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_3 AS STATU_ERND_SCS_PREM_COMM_AMT_3, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_4 AS STATU_ERND_SCS_PREM_COMM_AMT_4, WIGFI.STATU_ERND_SCS_PREM_COMM_AMT_5 AS STATU_ERND_SCS_PREM_COMM_AMT_5, WIGFI.STATU_ERND_RETRO_FEE_AMT AS STATU_ERND_RETRO_FEE_AMT, WIGFI.STATU_ERND_RFND_ADV_FEE_AMT AS STATU_ERND_RFND_ADV_FEE_AMT, WIGFI.STATU_ERND_RFND_PROMO_FEE_AMT AS STATU_ERND_RFND_PROMO_FEE_AMT, WIGFI.STATU_ERND_SURTY_PREM_AMT AS STATU_ERND_SURTY_PREM_AMT, WIGFI.STATU_ERND_VOLM_DISC_COMM_AMT AS STATU_ERND_VOLM_DISC_COMM_AMT, WIGFI.STATU_ERND_VOLM_DISC_PREM_AMT AS STATU_ERND_VOLM_DISC_PREM_AMT, WIGFI.SURTY_PREM_AMT AS SURTY_PREM_AMT, WIGFI.ULAE_AMT AS ULAE_AMT, WIGFI.VOLM_DISC_COMM_AMT AS VOLM_DISC_COMM_AMT, WIGFI.VOLM_DISC_PREM_AMT AS VOLM_DISC_PREM_AMT, WIGFI.PREM_TAX_AMT AS PREM_TAX_AMT, WIGFI.ASSET_DEF_FEE_AMT AS ASSET_DEF_FEE_AMT, WIGFI.CTRY_CD AS CTRY_CD, WIGFI.RETRO_CEDE_IND AS RETRO_CEDE_IND, WIGFI.SYS_PRCG_CD AS SYS_PRCG_CD, WIGFI.MGMT_CEDE_FEE_AMT AS MGMT_CEDE_FEE_AMT, WIGFI.MGMT_EXCS_TAX_AMT AS MGMT_EXCS_TAX_AMT, WIGFI.MGMT_PREM_TAX_AMT AS MGMT_PREM_TAX_AMT, WIGFI.STATU_CEDE_FEE_AMT AS STATU_CEDE_FEE_AMT, WIGFI.STATU_ERND_CONTRTRNSFR_FEE_AMT AS STATU_ERND_CONTRTRNSFR_FEE_AMT, WIGFI.STATU_EXCS_TAX_AMT AS STATU_EXCS_TAX_AMT, WIGFI.STATU_PREM_TAX_AMT AS STATU_PREM_TAX_AMT, COALESCE(LKP_BIL_TYPE.BIL_TYP_ALT_BUSN_KEY, -1), COALESCE(LKP_CTRY_CD.CTRY_ALT_BUSN_KEY, -1), COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS LOCAL_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS TRAN_CRCY_ALT_BUSN_KEY, COALESCE(LKP_LOCAL_CRCY.CRCY_ALT_BUSN_KEY, -1) AS CONTR_CRCY_ALT_BUSN_KEY, COALESCE(LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY, -1), COALESCE(LAR.ACTU_AND_FINC_DERVN_ALT_BUSN_KEY, -1), CAST('2999-12-31' AS DATE) AS EFF_TO_TISTMP, WIGFI.STAT_COMM_AMT AS STAT_COMM_AMT, WIGFI.DRVD_FINC_LOS_CATG_CD AS DRVD_FINC_LOS_CATG_CD, WIGFI.CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */ AS CLAIM_LOSS_ADJ_CHARGE_AMT, NOW() AS EFF_FRM_TISTMP FROM (SELECT ACC_EXPO_YR_MM AS WORK_INT_FFPL_PK, ASSM_REINS_AGMT_ANCHR_ID AS ACC_EXPO_YR_MM, BIL_TYP_CD AS ASSM_REINS_AGMT_ANCHR_ID, BULK_TRAN_IND AS BIL_TYP_CD, CLS_CD AS BULK_TRAN_IND, CEDE_REINS_AGMT_ANCHR_ID AS CLS_CD, CML_AGMT_ANCHR_ID AS CEDE_REINS_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID AS CML_AGMT_ANCHR_ID, CRCY_CD AS CMTN_AGMT_ANCHR_ID, DAC_CD AS CRCY_CD, EXC_CD AS DAC_CD, FIN_ACC_EXPO_YR_MM AS EXC_CD, FIN_CYC_PST_DT AS FIN_ACC_EXPO_YR_MM, FIN_PST_YR_MM AS FIN_CYC_PST_DT, LOB_ZA_GP_CD AS FIN_PST_YR_MM, MP_CD AS LOB_ZA_GP_CD, OPERT_CO_CD AS MP_CD, RETRO_RATG_CD AS OPERT_CO_CD, SRC_POL_EFF_DT AS RETRO_RATG_CD, SUSP_IND AS SRC_POL_EFF_DT, ST_NBR AS SUSP_IND, CMTN_IND AS ST_NBR, SUM(ACTL_LOS_RCVY_IDM_AMT) AS CMTN_IND, SUM(ADJR_ALAE_AMT) AS ACTL_LOS_RCVY_IDM_AMT, SUM(ANTCP_LOS_RCVY_IDM_AMT) AS ADJR_ALAE_AMT, SUM(BASE_ADMIN_FEE_AMT) AS ANTCP_LOS_RCVY_IDM_AMT, SUM(BASE_PREM_AMT) AS BASE_ADMIN_FEE_AMT, SUM(CEDE_FEE_AMT) AS BASE_PREM_AMT, SUM(CONTR_CAN_PAID_FEE_AMT) AS CEDE_FEE_AMT, SUM(CONTR_TRNSFR_FEE_AMT) AS CONTR_CAN_PAID_FEE_AMT, SUM(DELR_MRKP_AMT) AS CONTR_TRNSFR_FEE_AMT, SUM(DRCVY_ALAE_AMT) AS DELR_MRKP_AMT, SUM(DRCVY_IDM_LOS_AMT) AS DRCVY_ALAE_AMT, SUM(DRCVY_RSV_ALAE_AMT) AS DRCVY_IDM_LOS_AMT, SUM(DRCVY_RSV_IDM_AMT) AS DRCVY_RSV_ALAE_AMT, SUM(EXCS_TAX_AMT) AS DRCVY_RSV_IDM_AMT, SUM(LOSS_FUND_AMT) AS EXCS_TAX_AMT, SUM(LOSS_STBLZ_FEE_AMT) AS LOSS_FUND_AMT, SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) AS LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_BASE_PREM_AMT) AS MGMT_ERND_BASE_ADMIN_FEE_AMT, SUM(MGMT_ERND_CHRGCUSTCAN_AMT) AS MGMT_ERND_BASE_PREM_AMT, SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) AS MGMT_ERND_CHRGCUSTCAN_AMT, SUM(MGMT_ERND_DELR_MRKP_AMT) AS MGMT_ERND_CONTR_TRNSFR_FEE_AMT, SUM(MGMT_ERND_LOSS_FUND_AMT) AS MGMT_ERND_DELR_MRKP_AMT, SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) AS MGMT_ERND_LOSS_FUND_AMT, SUM(MGMT_ERND_MISC_PREM_AMT) AS MGMT_ERND_LOSS_STBLZ_FEE_AMT, SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) AS MGMT_ERND_MISC_PREM_AMT, SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) AS MGMT_ERND_NO_CHRGBCK_FEE_AMT, SUM(MGMT_ERND_NONRFND_PROMO_FEE) AS MGMT_ERND_NONRFND_ADV_FEE_AMT, SUM(MGMT_ERND_OVER_RMT_FEE_AMT) AS MGMT_ERND_NONRFND_PROMO_FEE, SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) AS MGMT_ERND_OVER_RMT_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) AS MGMT_ERND_PRTNR_COMM_FEE_AMT, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) AS MGMT_ERND_SCS_PREM_COMM_AMT_1, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) AS MGMT_ERND_SCS_PREM_COMM_AMT_2, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) AS MGMT_ERND_SCS_PREM_COMM_AMT_3, SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) AS MGMT_ERND_SCS_PREM_COMM_AMT_4, SUM(MGMT_ERND_RETRO_FEE_AMT) AS MGMT_ERND_SCS_PREM_COMM_AMT_5, SUM(MGMT_ERND_RFND_ADV_FEE_AMT) AS MGMT_ERND_RETRO_FEE_AMT, SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) AS MGMT_ERND_RFND_ADV_FEE_AMT, SUM(MGMT_ERND_SURTY_PREM_AMT) AS MGMT_ERND_RFND_PROMO_FEE_AMT, SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) AS MGMT_ERND_SURTY_PREM_AMT, SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_COMM_AMT, SUM(MISC_PREM_AMT) AS MGMT_ERND_VOLM_DISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) AS MISC_PREM_AMT, SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) AS NET_DRCVY_SLVG_SUBRO_PALAE_AMT, SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) AS NET_DRCVY_SLVG_SUBRO_PIDM_AMT, SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) AS NET_OF_DRCVY_LOS_RSV_ALAE_AMT, SUM(NO_CHRGBCK_FEE_AMT) AS NET_OF_DRCVY_LOS_RSV_IDM_AMT, SUM(NONRFND_ADV_FEE_AMT) AS NO_CHRGBCK_FEE_AMT, SUM(NONRFND_PROMO_FEE_AMT) AS NONRFND_ADV_FEE_AMT, SUM(OVER_RMT_FEE_AMT) AS NONRFND_PROMO_FEE_AMT, SUM(POOL_IBNR_CHG_AMT) AS OVER_RMT_FEE_AMT, SUM(PRTNR_COMM_FEE_AMT) AS POOL_IBNR_CHG_AMT, SUM(SCS_PREM_COMM_AMT_1) AS PRTNR_COMM_FEE_AMT, SUM(SCS_PREM_COMM_AMT_2) AS SCS_PREM_COMM_AMT_1, SUM(SCS_PREM_COMM_AMT_3) AS SCS_PREM_COMM_AMT_2, SUM(SCS_PREM_COMM_AMT_4) AS SCS_PREM_COMM_AMT_3, SUM(SCS_PREM_COMM_AMT_5) AS SCS_PREM_COMM_AMT_4, SUM(RETRO_FEE_AMT) AS SCS_PREM_COMM_AMT_5, SUM(RFND_ADV_FEE_AMT) AS RETRO_FEE_AMT, SUM(RFND_PROMO_FEE_AMT) AS RFND_ADV_FEE_AMT, SUM(SLVG_AND_SUBRO_ALAE_AMT) AS RFND_PROMO_FEE_AMT, SUM(SLVG_AND_SUBRO_IDM_AMT) AS SLVG_AND_SUBRO_ALAE_AMT, SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) AS SLVG_AND_SUBRO_IDM_AMT, SUM(STATU_ERND_BASE_PREM_AMT) AS STATU_ERND_BASE_ADMIN_FEE_AMT, SUM(STATU_ERND_CHRGCUSTCAN_AMT) AS STATU_ERND_BASE_PREM_AMT, SUM(STATU_ERND_DELR_MRKP_AMT) AS STATU_ERND_CHRGCUSTCAN_AMT, SUM(STATU_ERND_LOSS_FUND_AMT) AS STATU_ERND_DELR_MRKP_AMT, SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) AS STATU_ERND_LOSS_FUND_AMT, SUM(STATU_ERND_MISC_PREM_AMT) AS STATU_ERND_LOSS_STBLZ_FEE_AMT, SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) AS STATU_ERND_MISC_PREM_AMT, SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) AS STATU_ERND_NO_CHRGBCK_FEE_AMT, SUM(STATU_ERND_NONRFND_PROMO_FEE) AS STATU_ERND_NONRFND_ADV_FEE_AMT, SUM(STATU_ERND_OVER_RMT_FEE_AMT) AS STATU_ERND_NONRFND_PROMO_FEE, SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) AS STATU_ERND_OVER_RMT_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) AS STATU_ERND_PRTNR_COMM_FEE_AMT, SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) AS STATU_ERND_SCS_PREM_COMM_AMT_1, SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) AS STATU_ERND_SCS_PREM_COMM_AMT_2, SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) AS STATU_ERND_SCS_PREM_COMM_AMT_3, SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) AS STATU_ERND_SCS_PREM_COMM_AMT_4, SUM(STATU_ERND_RETRO_FEE_AMT) AS STATU_ERND_SCS_PREM_COMM_AMT_5, SUM(STATU_ERND_RFND_ADV_FEE_AMT) AS STATU_ERND_RETRO_FEE_AMT, SUM(STATU_ERND_RFND_PROMO_FEE_AMT) AS STATU_ERND_RFND_ADV_FEE_AMT, SUM(STATU_ERND_SURTY_PREM_AMT) AS STATU_ERND_RFND_PROMO_FEE_AMT, SUM(STATU_ERND_VOLM_DISC_COMM_AMT) AS STATU_ERND_SURTY_PREM_AMT, SUM(STATU_ERND_VOLM_DISC_PREM_AMT) AS STATU_ERND_VOLM_DISC_COMM_AMT, SUM(SURTY_PREM_AMT) AS STATU_ERND_VOLM_DISC_PREM_AMT, SUM(ULAE_AMT) AS SURTY_PREM_AMT, SUM(VOLM_DISC_COMM_AMT) AS ULAE_AMT, SUM(VOLM_DISC_PREM_AMT) AS VOLM_DISC_COMM_AMT, SUM(PREM_TAX_AMT) AS VOLM_DISC_PREM_AMT, SUM(ASSET_DEF_FEE_AMT) AS PREM_TAX_AMT, CTRY_CD AS ASSET_DEF_FEE_AMT, RETRO_CEDE_IND AS CTRY_CD, SYS_PRCG_CD AS RETRO_CEDE_IND, SUM(MGMT_CEDE_FEE_AMT) AS SYS_PRCG_CD, SUM(MGMT_EXCS_TAX_AMT) AS MGMT_CEDE_FEE_AMT, SUM(MGMT_PREM_TAX_AMT) AS MGMT_EXCS_TAX_AMT, SUM(STATU_CEDE_FEE_AMT) AS MGMT_PREM_TAX_AMT, SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) AS STATU_CEDE_FEE_AMT, SUM(STATU_EXCS_TAX_AMT) AS STATU_ERND_CONTRTRNSFR_FEE_AMT, SUM(STATU_PREM_TAX_AMT) AS STATU_EXCS_TAX_AMT, SUM(STAT_COMM_AMT) AS STATU_PREM_TAX_AMT, DRVD_FINC_LOS_CATG_CD AS BIL_TYP_ALT_BUSN_KEY, SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) AS CTRY_ALT_BUSN_KEY /* CR79 */ FROM work_init_gpng_finc_ins WHERE CML_AGMT_ANCHR_ID % 4 = 3 GROUP BY (ACC_EXPO_YR_MM, ASSM_REINS_AGMT_ANCHR_ID, BIL_TYP_CD, BULK_TRAN_IND, CLS_CD, CEDE_REINS_AGMT_ANCHR_ID, CML_AGMT_ANCHR_ID, CMTN_AGMT_ANCHR_ID, CRCY_CD, DAC_CD, EXC_CD, FIN_ACC_EXPO_YR_MM, FIN_CYC_PST_DT, FIN_PST_YR_MM, LOB_ZA_GP_CD, MP_CD, OPERT_CO_CD, RETRO_RATG_CD, SRC_POL_EFF_DT, SUSP_IND, ST_NBR, CMTN_IND, CTRY_CD, RETRO_CEDE_IND, SYS_PRCG_CD, DRVD_FINC_LOS_CATG_CD, CLAIM_LOSS_ADJ_CHARGE_AMT /* CR79 */) HAVING SUM(ACTL_LOS_RCVY_IDM_AMT) <> 0 OR SUM(ADJR_ALAE_AMT) <> 0 OR SUM(ANTCP_LOS_RCVY_IDM_AMT) <> 0 OR SUM(BASE_ADMIN_FEE_AMT) <> 0 OR SUM(BASE_PREM_AMT) <> 0 OR SUM(CEDE_FEE_AMT) <> 0 OR SUM(CONTR_CAN_PAID_FEE_AMT) <> 0 OR SUM(CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(DELR_MRKP_AMT) <> 0 OR SUM(DRCVY_ALAE_AMT) <> 0 OR SUM(DRCVY_IDM_LOS_AMT) <> 0 OR SUM(DRCVY_RSV_ALAE_AMT) <> 0 OR SUM(DRCVY_RSV_IDM_AMT) <> 0 OR SUM(EXCS_TAX_AMT) <> 0 OR SUM(LOSS_FUND_AMT) <> 0 OR SUM(LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(MGMT_ERND_BASE_PREM_AMT) <> 0 OR SUM(MGMT_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(MGMT_ERND_CONTR_TRNSFR_FEE_AMT) <> 0 OR SUM(MGMT_ERND_DELR_MRKP_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_FUND_AMT) <> 0 OR SUM(MGMT_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(MGMT_ERND_MISC_PREM_AMT) <> 0 OR SUM(MGMT_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(MGMT_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(MGMT_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(MGMT_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(MGMT_ERND_RETRO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(MGMT_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(MGMT_ERND_SURTY_PREM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(MGMT_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(MISC_PREM_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PALAE_AMT) <> 0 OR SUM(NET_DRCVY_SLVG_SUBRO_PIDM_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_ALAE_AMT) <> 0 OR SUM(NET_OF_DRCVY_LOS_RSV_IDM_AMT) <> 0 OR SUM(NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(NONRFND_ADV_FEE_AMT) <> 0 OR SUM(NONRFND_PROMO_FEE_AMT) <> 0 OR SUM(OVER_RMT_FEE_AMT) <> 0 OR SUM(POOL_IBNR_CHG_AMT) <> 0 OR SUM(PRTNR_COMM_FEE_AMT) <> 0 OR SUM(SCS_PREM_COMM_AMT_1) <> 0 OR SUM(SCS_PREM_COMM_AMT_2) <> 0 OR SUM(SCS_PREM_COMM_AMT_3) <> 0 OR SUM(SCS_PREM_COMM_AMT_4) <> 0 OR SUM(SCS_PREM_COMM_AMT_5) <> 0 OR SUM(RETRO_FEE_AMT) <> 0 OR SUM(RFND_ADV_FEE_AMT) <> 0 OR SUM(RFND_PROMO_FEE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_ALAE_AMT) <> 0 OR SUM(SLVG_AND_SUBRO_IDM_AMT) <> 0 OR SUM(STATU_ERND_BASE_ADMIN_FEE_AMT) <> 0 OR SUM(STATU_ERND_BASE_PREM_AMT) <> 0 OR SUM(STATU_ERND_CHRGCUSTCAN_AMT) <> 0 OR SUM(STATU_ERND_DELR_MRKP_AMT) <> 0 OR SUM(STATU_ERND_LOSS_FUND_AMT) <> 0 OR SUM(STATU_ERND_LOSS_STBLZ_FEE_AMT) <> 0 OR SUM(STATU_ERND_MISC_PREM_AMT) <> 0 OR SUM(STATU_ERND_NO_CHRGBCK_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_NONRFND_PROMO_FEE) <> 0 OR SUM(STATU_ERND_OVER_RMT_FEE_AMT) <> 0 OR SUM(STATU_ERND_PRTNR_COMM_FEE_AMT) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_1) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_2) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_3) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_4) <> 0 OR SUM(STATU_ERND_SCS_PREM_COMM_AMT_5) <> 0 OR SUM(STATU_ERND_RETRO_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_ADV_FEE_AMT) <> 0 OR SUM(STATU_ERND_RFND_PROMO_FEE_AMT) <> 0 OR SUM(STATU_ERND_SURTY_PREM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_COMM_AMT) <> 0 OR SUM(STATU_ERND_VOLM_DISC_PREM_AMT) <> 0 OR SUM(SURTY_PREM_AMT) <> 0 OR SUM(ULAE_AMT) <> 0 OR SUM(VOLM_DISC_COMM_AMT) <> 0 OR SUM(VOLM_DISC_PREM_AMT) <> 0 OR SUM(PREM_TAX_AMT) <> 0 OR SUM(ASSET_DEF_FEE_AMT) <> 0 OR SUM(MGMT_CEDE_FEE_AMT) <> 0 OR SUM(MGMT_EXCS_TAX_AMT) <> 0 OR SUM(MGMT_PREM_TAX_AMT) <> 0 OR SUM(STATU_CEDE_FEE_AMT) <> 0 OR SUM(STATU_ERND_CONTRTRNSFR_FEE_AMT) <> 0 OR SUM(STATU_EXCS_TAX_AMT) <> 0 OR SUM(STATU_PREM_TAX_AMT) <> 0 OR SUM(STAT_COMM_AMT) <> 0 OR SUM(CLAIM_LOSS_ADJ_CHARGE_AMT) <> 0 /* CR79 */) AS WIGFI INNER JOIN lkup_prem_postal_regn_co AS LPPRC ON (WIGFI.OPERT_CO_CD = LPPRC.OPERT_CO_CD AND WIGFI.ST_NBR = LPPRC.PREM_POSTAL_REGN_CD AND WIGFI.FIN_PST_YR_MM >= LPPRC.EFF_FM_CCYYMM AND WIGFI.FIN_PST_YR_MM <= LPPRC.EFF_TO_CCYYMM) LEFT OUTER JOIN cml_agmt AS LKP_CML_AGMT ON (LKP_CML_AGMT.AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_CML_AGMT.ACTV_REC_IND = 'Y') /*
LEFT OUTER JOIN work_prcg_cyc_dt WPCD 
ON WPCD.ACTV_REC_IND = 'Y' And WPCD.TYP_ID = 79
*/ LEFT OUTER JOIN dim_bil_typ_late_actv AS LKP_BIL_TYPE ON (LKP_BIL_TYPE.BIL_TYP_CD = CASE WHEN RTRIM(WIGFI.BIL_TYP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.BIL_TYP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.BIL_TYP_CD) END AND LKP_BIL_TYPE.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ctry AS LKP_CTRY_CD ON (LKP_CTRY_CD.CTRY_NBR = CASE WHEN RTRIM(WIGFI.CTRY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CTRY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CTRY_CD) END AND LKP_CTRY_CD.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_crcy AS LKP_LOCAL_CRCY ON (LKP_LOCAL_CRCY.CRCY_CD = CASE WHEN RTRIM(WIGFI.CRCY_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CRCY_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CRCY_CD) END AND LKP_LOCAL_CRCY.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN ON (LKP_DIM_REIN.REINS_AGMT_ANCHR_ID = WIGFI.ASSM_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_reins_agmt AS LKP_DIM_REIN1 ON (LKP_DIM_REIN1.REINS_AGMT_ANCHR_ID = WIGFI.CEDE_REINS_AGMT_ANCHR_ID AND LKP_DIM_REIN1.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_cmtn_agmt AS LKP_DIM_CMTN ON (LKP_DIM_CMTN.CMTN_AGMT_ANCHR_ID = WIGFI.CMTN_AGMT_ANCHR_ID AND LKP_DIM_CMTN.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_ins_pol_and_rlup_late_actv_mm AS LKP_DIM_DIPR ON (LKP_DIM_DIPR.CML_AGMT_ANCHR_ID = WIGFI.CML_AGMT_ANCHR_ID AND LKP_DIM_DIPR.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob AS LKP_DIM_DCL ON (LKP_DIM_DCL.ZA_COVG_CD = CASE WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.LOB_ZA_GP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.LOB_ZA_GP_CD) END AND LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS LKP_DIM_ST ON (LKP_DIM_ST.ST_NBR = CASE WHEN RTRIM(WIGFI.ST_NBR) = '' THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.ST_NBR) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.ST_NBR) END AND LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_dir_assm_cede AS LKP_DIM_DDAC ON (LKP_DIM_DDAC.DIR_ASSM_CEDE_CD = CASE WHEN RTRIM(WIGFI.DAC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.DAC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.DAC_CD) END AND LKP_DIM_DDAC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_mlt_prl AS LKP_DIM_DMPL ON (LKP_DIM_DMPL.MLT_PRL_CD = CASE WHEN RTRIM(WIGFI.MP_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.MP_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.MP_CD) END AND LKP_DIM_DMPL.LATE_ACTV_REC_IND = 'Y') INNER JOIN dim_covg_lob_cls_late_actv AS LKP_DIM_CLC ON (LKP_DIM_CLC.CLS_CD = CASE WHEN RTRIM(WIGFI.CLS_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.CLS_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.CLS_CD) END AND LKP_DIM_CLC.COVG_LOB_ALT_BUSN_KEY = LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LKP_DIM_CLC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS LKP_DIM_DINS ON (LKP_DIM_DINS.OPERT_CO_CD = CASE WHEN RTRIM(WIGFI.OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.OPERT_CO_CD) END AND LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_exc_late_actv AS LKP_DIM_DEXC ON (LKP_DIM_DEXC.EXC_CD = CASE WHEN RTRIM(WIGFI.EXC_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.EXC_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.EXC_CD) END AND LKP_DIM_DEXC.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_retro_ratg_late_actv AS LKP_DIM_DRR ON (LKP_DIM_DRR.RETRO_RATG_CD = CASE WHEN RTRIM(WIGFI.RETRO_RATG_CD) = '' THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) IS NULL THEN 'UNK' WHEN RTRIM(WIGFI.RETRO_RATG_CD) = 'null' THEN 'UNK' ELSE RTRIM(WIGFI.RETRO_RATG_CD) END AND LKP_DIM_DRR.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_insr AS H_LKP_DIM_DINS ON (RTRIM(H_LKP_DIM_DINS.OPERT_CO_CD) = CASE WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_OPERT_CO_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_OPERT_CO_CD) END AND H_LKP_DIM_DINS.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN dim_st AS H_LKP_DIM_ST ON (RTRIM(H_LKP_DIM_ST.ST_NBR) = CASE WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = '' THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) IS NULL THEN 'UNK' WHEN RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) = 'null' THEN 'UNK' ELSE RTRIM(LPPRC.FINC_PREM_POSTAL_REGION_CD) END AND H_LKP_DIM_ST.LATE_ACTV_REC_IND = 'Y') LEFT JOIN work_actu_and_fin_pol AS AFP ON LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY = AFP.INS_POL_AND_RLUP_ALT_BUSN_KEY AND AFP.LATE_ACTV_REC_IND = 'Y' LEFT JOIN (SELECT DISTINCT LOB_ZA_GP_CD AS WORK_INT_FFPL_PK, ETL_IND AS ACC_EXPO_YR_MM FROM dim_lob_za_gp_cd AS lkp_src) AS DLZ ON DLZ.LOB_ZA_GP_CD = RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) AND ETL_IND = 'N' /* DLZ.LOB_ZA_GP_CD if it is not null then set as Financial LOB ZA Group Code */ LEFT JOIN work_maj_ln_dflt_asmt AS MLDA ON MLDA.MAJ_LN_CD = SUBSTR(RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END), 1, 2) /* - SUBSTR(RTRIM(DECODE(rtrim((WIGFI.LOB_ZA_GP_CD)),'','UNK',NULL,'UNK','null','UNK',WIGFI.LOB_ZA_GP_CD)),1,2) || MLDA.SUB_LN_CD || MLDA.COVG_CD THIS WILL BE APPLY WHEN IN ABOCE FINC CODE IS NULL */ LEFT JOIN cd ON CD.CD_VAL = AFP.POL_SYM_CD AND CD.CD_SCM = 'POLICY_SYMBOL_F&I' AND CD.ACTV_REC_IND = 'Y' /* THEN SET FINC_LOB_ZA_GP_CD ='526001' */ LEFT JOIN (SELECT OPERT_CO_CD AS WORK_INT_FFPL_PK FROM extl_org AS EO, $$DBOwnerATM.dbaall.EXTL_ORG_DTL AS EOD WHERE EO.TYP_ID = 26 AND EO.ROL_PLYR_ANCHR_ID = EOD.ROL_PLYR_ANCHR_ID AND EO.ACTV_REC_IND = 'Y' AND EOD.ACTV_REC_IND = 'Y' AND EOD.DOMCL_LOC_CD = 'CAN') AS ABC ON ABC.OPERT_CO_CD = AFP.OPERT_CO_CD LEFT OUTER JOIN dim_covg_lob AS H_LKP_DIM_DCL ON (RTRIM(H_LKP_DIM_DCL.ZA_COVG_CD) = CASE WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = '' THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) IS NULL THEN 'UNK' WHEN RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) = 'null' THEN 'UNK' ELSE RTRIM(CASE WHEN NOT DLZ.LOB_ZA_GP_CD IS NULL THEN RTRIM(CASE WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = '' THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) IS NULL THEN 'UNK' WHEN RTRIM((WIGFI.LOB_ZA_GP_CD)) = 'null' THEN 'UNK' ELSE WIGFI.LOB_ZA_GP_CD END) ELSE CASE WHEN NOT MLDA.MAJ_LN_CD IS NULL THEN SUBSTR(WIGFI.LOB_ZA_GP_CD, 1, 2) || MLDA.SUB_LN_CD || MLDA.COVG_CD ELSE CASE WHEN NOT CD.CD_VAL IS NULL THEN '526001' ELSE CASE WHEN NOT ABC.OPERT_CO_CD IS NULL THEN '735930' ELSE '501801' END END END END) END AND H_LKP_DIM_DCL.LATE_ACTV_REC_IND = 'Y') LEFT OUTER JOIN late_active_records AS LAR ON (LAR.ACC_EXPO_YY = SUBSTR(WIGFI.ACC_EXPO_YR_MM, 1, 4) AND LAR.FINC_ACC_EXPO_YY = SUBSTR(WIGFI.FIN_ACC_EXPO_YR_MM, 1, 4) AND LAR.ASSM_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN.REINS_AGMT_ALT_BUSN_KEY AND LAR.CEDE_REINS_AGMT_ALT_BUSN_KEY = LKP_DIM_REIN1.REINS_AGMT_ALT_BUSN_KEY AND LAR.CMTN_AGMT_ALT_BUSN_KEY = LKP_DIM_CMTN.CMTN_AGMT_ALT_BUSN_KEY AND LAR.INS_POL_AND_RLUP_ALT_BUSN_KEY = LKP_DIM_DIPR.INS_POL_AND_RLUP_ALT_BUSN_KEY AND LAR.ST_ALT_BUSN_KEY = LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.DIR_ASSM_CEDE_ALT_BUSN_KEY = LKP_DIM_DDAC.DIR_ASSM_CEDE_ALT_BUSN_KEY AND LAR.MLT_PRL_ALT_BUSN_KEY = LKP_DIM_DMPL.MLT_PRL_ALT_BUSN_KEY AND LAR.COVG_LOB_CLS_ALT_BUSN_KEY = COALESCE(LKP_DIM_CLC.COVG_LOB_CLS_ALT_BUSN_KEY, -1) AND LAR.INSR_ALT_BUSN_KEY = LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.EXC_ALT_BUSN_KEY = LKP_DIM_DEXC.EXC_ALT_BUSN_KEY AND LAR.RETRO_RATG_ALT_BUSN_KEY = LKP_DIM_DRR.RETRO_RATG_ALT_BUSN_KEY AND LAR.SUSP_IND = WIGFI.SUSP_IND AND LAR.FINC_INSR_ALT_BUSN_KEY = H_LKP_DIM_DINS.INSR_ALT_BUSN_KEY AND LAR.FINC_COVG_LOB_ALT_BUSN_KEY = H_LKP_DIM_DCL.COVG_LOB_ALT_BUSN_KEY AND LAR.FINC_PREM_ST_ALT_BUSN_KEY = H_LKP_DIM_ST.ST_ALT_BUSN_KEY AND LAR.RETRO_CEDE_IND = WIGFI.RETRO_CEDE_IND) /* --------- END QUERY --------------- */),
exp_src_anchor as (
    select
        work_int_ffpl_pk,
        acc_expo_yr_mm,
        assm_reins_agmt_anchr_id,
        bil_typ_cd,
        bulk_tran_ind,
        cls_cd,
        cede_reins_agmt_anchr_id,
        cml_agmt_anchr_id,
        cmtn_agmt_anchr_id,
        crcy_cd,
        dac_cd,
        exc_cd,
        fin_acc_expo_yr_mm,
        fin_cyc_pst_dt,
        fin_pst_yr_mm,
        lob_za_gp_cd,
        mp_cd,
        opert_co_cd,
        retro_ratg_cd,
        src_pol_eff_dt,
        susp_ind,
        st_nbr,
        cmtn_ind,
        actl_los_rcvy_idm_amt,
        adjr_alae_amt,
        antcp_los_rcvy_idm_amt,
        base_admin_fee_amt,
        base_prem_amt,
        cede_fee_amt,
        contr_can_paid_fee_amt,
        contr_trnsfr_fee_amt,
        delr_mrkp_amt,
        drcvy_alae_amt,
        drcvy_idm_los_amt,
        drcvy_rsv_alae_amt,
        drcvy_rsv_idm_amt,
        excs_tax_amt,
        loss_fund_amt,
        loss_stblz_fee_amt,
        mgmt_ernd_base_admin_fee_amt,
        mgmt_ernd_base_prem_amt,
        mgmt_ernd_chrgcustcan_amt,
        mgmt_ernd_contr_trnsfr_fee_amt,
        mgmt_ernd_delr_mrkp_amt,
        mgmt_ernd_loss_fund_amt,
        mgmt_ernd_loss_stblz_fee_amt,
        mgmt_ernd_misc_prem_amt,
        mgmt_ernd_no_chrgbck_fee_amt,
        mgmt_ernd_nonrfnd_adv_fee_amt,
        mgmt_ernd_nonrfnd_promo_fee,
        mgmt_ernd_over_rmt_fee_amt,
        mgmt_ernd_prtnr_comm_fee_amt,
        mgmt_ernd_scs_prem_comm_amt_1,
        mgmt_ernd_scs_prem_comm_amt_2,
        mgmt_ernd_scs_prem_comm_amt_3,
        mgmt_ernd_scs_prem_comm_amt_4,
        mgmt_ernd_scs_prem_comm_amt_5,
        mgmt_ernd_retro_fee_amt,
        mgmt_ernd_rfnd_adv_fee_amt,
        mgmt_ernd_rfnd_promo_fee_amt,
        mgmt_ernd_surty_prem_amt,
        mgmt_ernd_volm_disc_comm_amt,
        mgmt_ernd_volm_disc_prem_amt,
        misc_prem_amt,
        net_drcvy_slvg_subro_palae_amt,
        net_drcvy_slvg_subro_pidm_amt,
        net_of_drcvy_los_rsv_alae_amt,
        net_of_drcvy_los_rsv_idm_amt,
        no_chrgbck_fee_amt,
        nonrfnd_adv_fee_amt,
        nonrfnd_promo_fee_amt,
        over_rmt_fee_amt,
        pool_ibnr_chg_amt,
        prtnr_comm_fee_amt,
        scs_prem_comm_amt_1,
        scs_prem_comm_amt_2,
        scs_prem_comm_amt_3,
        scs_prem_comm_amt_4,
        scs_prem_comm_amt_5,
        retro_fee_amt,
        rfnd_adv_fee_amt,
        rfnd_promo_fee_amt,
        slvg_and_subro_alae_amt,
        slvg_and_subro_idm_amt,
        statu_ernd_base_admin_fee_amt,
        statu_ernd_base_prem_amt,
        statu_ernd_chrgcustcan_amt,
        statu_ernd_delr_mrkp_amt,
        statu_ernd_loss_fund_amt,
        statu_ernd_loss_stblz_fee_amt,
        statu_ernd_misc_prem_amt,
        statu_ernd_no_chrgbck_fee_amt,
        statu_ernd_nonrfnd_adv_fee_amt,
        statu_ernd_nonrfnd_promo_fee,
        statu_ernd_over_rmt_fee_amt,
        statu_ernd_prtnr_comm_fee_amt,
        statu_ernd_scs_prem_comm_amt_1,
        statu_ernd_scs_prem_comm_amt_2,
        statu_ernd_scs_prem_comm_amt_3,
        statu_ernd_scs_prem_comm_amt_4,
        statu_ernd_scs_prem_comm_amt_5,
        statu_ernd_retro_fee_amt,
        statu_ernd_rfnd_adv_fee_amt,
        statu_ernd_rfnd_promo_fee_amt,
        statu_ernd_surty_prem_amt,
        statu_ernd_volm_disc_comm_amt,
        statu_ernd_volm_disc_prem_amt,
        surty_prem_amt,
        ulae_amt,
        volm_disc_comm_amt,
        volm_disc_prem_amt,
        prem_tax_amt,
        asset_def_fee_amt,
        ctry_cd,
        retro_cede_ind,
        sys_prcg_cd,
        mgmt_cede_fee_amt,
        mgmt_excs_tax_amt,
        mgmt_prem_tax_amt,
        statu_cede_fee_amt,
        statu_ernd_contrtrnsfr_fee_amt,
        statu_excs_tax_amt,
        statu_prem_tax_amt,
        bil_typ_alt_busn_key,
        ctry_alt_busn_key,
        local_crcy_alt_busn_key,
        tran_crcy_alt_busn_key,
        contr_crcy_alt_busn_key,
        ins_pol_and_rlup_alt_busn_key,
        actu_and_finc_dervn_alt_busn_key,
        eff_to_tistmp,
        {{ var("pop_info_id") }} as o_pop_info_id,
        {{ var("pop_info_id") }} as o_updt_pop_info_id,
        {{ var("bat_id") }} as o_bat_id,
        stat_comm_amt,
        drvd_finc_los_catg_cd,
        claim_loss_adj_charge_amt,
        eff_frm_tistmp
    from sq_work_init_gpng_finc_ins
),
exp_tgt_anchor as (
    select
        work_int_ffpl_pk,
        bil_typ_alt_busn_key,
        ctry_alt_busn_key,
        local_crcy_alt_busn_key,
        tran_crcy_alt_busn_key,
        contr_crcy_alt_busn_key,
        ins_pol_and_rlup_alt_busn_key,
        actu_and_finc_dervn_alt_busn_key,
        acc_expo_yr_mm,
        assm_reins_agmt_anchr_id,
        bil_typ_cd,
        bulk_tran_ind,
        cls_cd,
        cede_reins_agmt_anchr_id,
        cml_agmt_anchr_id,
        cmtn_agmt_anchr_id,
        crcy_cd,
        dac_cd,
        exc_cd,
        fin_acc_expo_yr_mm,
        fin_cyc_pst_dt,
        fin_pst_yr_mm,
        lob_za_gp_cd,
        mp_cd,
        opert_co_cd,
        retro_ratg_cd,
        src_pol_eff_dt,
        susp_ind,
        st_nbr,
        cmtn_ind,
        actl_los_rcvy_idm_amt,
        adjr_alae_amt,
        antcp_los_rcvy_idm_amt,
        base_admin_fee_amt,
        base_prem_amt,
        cede_fee_amt,
        contr_can_paid_fee_amt,
        contr_trnsfr_fee_amt,
        delr_mrkp_amt,
        drcvy_alae_amt,
        drcvy_idm_los_amt,
        drcvy_rsv_alae_amt,
        drcvy_rsv_idm_amt,
        excs_tax_amt,
        loss_fund_amt,
        loss_stblz_fee_amt,
        mgmt_ernd_base_admin_fee_amt,
        mgmt_ernd_base_prem_amt,
        mgmt_ernd_chrgcustcan_amt,
        mgmt_ernd_contr_trnsfr_fee_amt,
        mgmt_ernd_delr_mrkp_amt,
        mgmt_ernd_loss_fund_amt,
        mgmt_ernd_loss_stblz_fee_amt,
        mgmt_ernd_misc_prem_amt,
        mgmt_ernd_no_chrgbck_fee_amt,
        mgmt_ernd_nonrfnd_adv_fee_amt,
        mgmt_ernd_nonrfnd_promo_fee,
        mgmt_ernd_over_rmt_fee_amt,
        mgmt_ernd_prtnr_comm_fee_amt,
        mgmt_ernd_scs_prem_comm_amt_1,
        mgmt_ernd_scs_prem_comm_amt_2,
        mgmt_ernd_scs_prem_comm_amt_3,
        mgmt_ernd_scs_prem_comm_amt_4,
        mgmt_ernd_scs_prem_comm_amt_5,
        mgmt_ernd_retro_fee_amt,
        mgmt_ernd_rfnd_adv_fee_amt,
        mgmt_ernd_rfnd_promo_fee_amt,
        mgmt_ernd_surty_prem_amt,
        mgmt_ernd_volm_disc_comm_amt,
        mgmt_ernd_volm_disc_prem_amt,
        misc_prem_amt,
        net_drcvy_slvg_subro_palae_amt,
        net_drcvy_slvg_subro_pidm_amt,
        net_of_drcvy_los_rsv_alae_amt,
        net_of_drcvy_los_rsv_idm_amt,
        no_chrgbck_fee_amt,
        nonrfnd_adv_fee_amt,
        nonrfnd_promo_fee_amt,
        over_rmt_fee_amt,
        pool_ibnr_chg_amt,
        prtnr_comm_fee_amt,
        scs_prem_comm_amt_1,
        scs_prem_comm_amt_2,
        scs_prem_comm_amt_3,
        scs_prem_comm_amt_4,
        scs_prem_comm_amt_5,
        retro_fee_amt,
        rfnd_adv_fee_amt,
        rfnd_promo_fee_amt,
        slvg_and_subro_alae_amt,
        slvg_and_subro_idm_amt,
        statu_ernd_base_admin_fee_amt,
        statu_ernd_base_prem_amt,
        statu_ernd_chrgcustcan_amt,
        statu_ernd_delr_mrkp_amt,
        statu_ernd_loss_fund_amt,
        statu_ernd_loss_stblz_fee_amt,
        statu_ernd_misc_prem_amt,
        statu_ernd_no_chrgbck_fee_amt,
        statu_ernd_nonrfnd_adv_fee_amt,
        statu_ernd_nonrfnd_promo_fee,
        statu_ernd_over_rmt_fee_amt,
        statu_ernd_prtnr_comm_fee_amt,
        statu_ernd_scs_prem_comm_amt_1,
        statu_ernd_scs_prem_comm_amt_2,
        statu_ernd_scs_prem_comm_amt_3,
        statu_ernd_scs_prem_comm_amt_4,
        statu_ernd_scs_prem_comm_amt_5,
        statu_ernd_retro_fee_amt,
        statu_ernd_rfnd_adv_fee_amt,
        statu_ernd_rfnd_promo_fee_amt,
        statu_ernd_surty_prem_amt,
        statu_ernd_volm_disc_comm_amt,
        statu_ernd_volm_disc_prem_amt,
        surty_prem_amt,
        ulae_amt,
        volm_disc_comm_amt,
        volm_disc_prem_amt,
        prem_tax_amt,
        asset_def_fee_amt,
        ctry_cd,
        retro_cede_ind,
        sys_prcg_cd,
        mgmt_cede_fee_amt,
        mgmt_excs_tax_amt,
        mgmt_prem_tax_amt,
        statu_cede_fee_amt,
        statu_ernd_contrtrnsfr_fee_amt,
        statu_excs_tax_amt,
        statu_prem_tax_amt,
        o_pop_info_id as pop_info_id,
        o_updt_pop_info_id as updt_pop_info_id,
        o_bat_id as bat_id,
        eff_to_tistmp,
        stat_comm_amt,
        drvd_finc_los_catg_cd,
        claim_loss_adj_charge_amt,
        eff_frm_tistmp
    from exp_src_anchor
),
select
    work_int_ffpl_pk as work_int_ffpl_pk,
    bil_typ_alt_busn_key as bil_typ_alt_busn_key,
    ctry_alt_busn_key as ctry_alt_busn_key,
    local_crcy_alt_busn_key as local_crcy_alt_busn_key,
    tran_crcy_alt_busn_key as tran_crcy_alt_busn_key,
    contr_crcy_alt_busn_key as contr_crcy_alt_busn_key,
    ins_pol_and_rlup_alt_busn_key as ins_pol_and_rlup_alt_busn_key,
    actu_and_finc_dervn_alt_busn_key as actu_and_finc_dervn_alt_busn_key,
    acc_expo_yr_mm as acc_expo_yr_mm,
    assm_reins_agmt_anchr_id as assm_reins_agmt_anchr_id,
    bil_typ_cd as bil_typ_cd,
    bulk_tran_ind as bulk_tran_ind,
    cls_cd as cls_cd,
    cede_reins_agmt_anchr_id as cede_reins_agmt_anchr_id,
    cml_agmt_anchr_id as cml_agmt_anchr_id,
    cmtn_agmt_anchr_id as cmtn_agmt_anchr_id,
    crcy_cd as crcy_cd,
    dac_cd as dac_cd,
    exc_cd as exc_cd,
    fin_acc_expo_yr_mm as fin_acc_expo_yr_mm,
    fin_cyc_pst_dt as fin_cyc_pst_dt,
    fin_pst_yr_mm as fin_pst_yr_mm,
    lob_za_gp_cd as lob_za_gp_cd,
    mp_cd as mp_cd,
    opert_co_cd as opert_co_cd,
    retro_ratg_cd as retro_ratg_cd,
    src_pol_eff_dt as src_pol_eff_dt,
    susp_ind as susp_ind,
    st_nbr as st_nbr,
    cmtn_ind as cmtn_ind,
    actl_los_rcvy_idm_amt as actl_los_rcvy_idm_amt,
    adjr_alae_amt as adjr_alae_amt,
    antcp_los_rcvy_idm_amt as antcp_los_rcvy_idm_amt,
    base_admin_fee_amt as base_admin_fee_amt,
    base_prem_amt as base_prem_amt,
    cede_fee_amt as cede_fee_amt,
    contr_can_paid_fee_amt as contr_can_paid_fee_amt,
    contr_trnsfr_fee_amt as contr_trnsfr_fee_amt,
    delr_mrkp_amt as delr_mrkp_amt,
    drcvy_alae_amt as drcvy_alae_amt,
    drcvy_idm_los_amt as drcvy_idm_los_amt,
    drcvy_rsv_alae_amt as drcvy_rsv_alae_amt,
    drcvy_rsv_idm_amt as drcvy_rsv_idm_amt,
    excs_tax_amt as excs_tax_amt,
    loss_fund_amt as loss_fund_amt,
    loss_stblz_fee_amt as loss_stblz_fee_amt,
    mgmt_ernd_base_admin_fee_amt as mgmt_ernd_base_admin_fee_amt,
    mgmt_ernd_base_prem_amt as mgmt_ernd_base_prem_amt,
    mgmt_ernd_chrgcustcan_amt as mgmt_ernd_chrgcustcan_amt,
    mgmt_ernd_contr_trnsfr_fee_amt as mgmt_ernd_contr_trnsfr_fee_amt,
    mgmt_ernd_delr_mrkp_amt as mgmt_ernd_delr_mrkp_amt,
    mgmt_ernd_loss_fund_amt as mgmt_ernd_loss_fund_amt,
    mgmt_ernd_loss_stblz_fee_amt as mgmt_ernd_loss_stblz_fee_amt,
    mgmt_ernd_misc_prem_amt as mgmt_ernd_misc_prem_amt,
    mgmt_ernd_no_chrgbck_fee_amt as mgmt_ernd_no_chrgbck_fee_amt,
    mgmt_ernd_nonrfnd_adv_fee_amt as mgmt_ernd_nonrfnd_adv_fee_amt,
    mgmt_ernd_nonrfnd_promo_fee as mgmt_ernd_nonrfnd_promo_fee,
    mgmt_ernd_over_rmt_fee_amt as mgmt_ernd_over_rmt_fee_amt,
    mgmt_ernd_prtnr_comm_fee_amt as mgmt_ernd_prtnr_comm_fee_amt,
    mgmt_ernd_retro_fee_amt as mgmt_ernd_retro_fee_amt,
    mgmt_ernd_rfnd_adv_fee_amt as mgmt_ernd_rfnd_adv_fee_amt,
    mgmt_ernd_rfnd_promo_fee_amt as mgmt_ernd_rfnd_promo_fee_amt,
    mgmt_ernd_surty_prem_amt as mgmt_ernd_surty_prem_amt,
    mgmt_ernd_volm_disc_comm_amt as mgmt_ernd_volm_disc_comm_amt,
    mgmt_ernd_volm_disc_prem_amt as mgmt_ernd_volm_disc_prem_amt,
    misc_prem_amt as misc_prem_amt,
    net_drcvy_slvg_subro_palae_amt as net_drcvy_slvg_subro_palae_amt,
    net_drcvy_slvg_subro_pidm_amt as net_drcvy_slvg_subro_pidm_amt,
    net_of_drcvy_los_rsv_alae_amt as net_of_drcvy_los_rsv_alae_amt,
    net_of_drcvy_los_rsv_idm_amt as net_of_drcvy_los_rsv_idm_amt,
    no_chrgbck_fee_amt as no_chrgbck_fee_amt,
    nonrfnd_adv_fee_amt as nonrfnd_adv_fee_amt,
    nonrfnd_promo_fee_amt as nonrfnd_promo_fee_amt,
    over_rmt_fee_amt as over_rmt_fee_amt,
    pool_ibnr_chg_amt as pool_ibnr_chg_amt,
    prtnr_comm_fee_amt as prtnr_comm_fee_amt,
    retro_fee_amt as retro_fee_amt,
    rfnd_adv_fee_amt as rfnd_adv_fee_amt,
    rfnd_promo_fee_amt as rfnd_promo_fee_amt,
    slvg_and_subro_alae_amt as slvg_and_subro_alae_amt,
    slvg_and_subro_idm_amt as slvg_and_subro_idm_amt,
    statu_ernd_base_admin_fee_amt as statu_ernd_base_admin_fee_amt,
    statu_ernd_base_prem_amt as statu_ernd_base_prem_amt,
    statu_ernd_chrgcustcan_amt as statu_ernd_chrgcustcan_amt,
    statu_ernd_delr_mrkp_amt as statu_ernd_delr_mrkp_amt,
    statu_ernd_loss_fund_amt as statu_ernd_loss_fund_amt,
    statu_ernd_loss_stblz_fee_amt as statu_ernd_loss_stblz_fee_amt,
    statu_ernd_misc_prem_amt as statu_ernd_misc_prem_amt,
    statu_ernd_no_chrgbck_fee_amt as statu_ernd_no_chrgbck_fee_amt,
    statu_ernd_nonrfnd_adv_fee_amt as statu_ernd_nonrfnd_adv_fee_amt,
    statu_ernd_nonrfnd_promo_fee as statu_ernd_nonrfnd_promo_fee,
    statu_ernd_over_rmt_fee_amt as statu_ernd_over_rmt_fee_amt,
    statu_ernd_prtnr_comm_fee_amt as statu_ernd_prtnr_comm_fee_amt,
    statu_ernd_retro_fee_amt as statu_ernd_retro_fee_amt,
    statu_ernd_rfnd_adv_fee_amt as statu_ernd_rfnd_adv_fee_amt,
    statu_ernd_rfnd_promo_fee_amt as statu_ernd_rfnd_promo_fee_amt,
    statu_ernd_surty_prem_amt as statu_ernd_surty_prem_amt,
    statu_ernd_volm_disc_comm_amt as statu_ernd_volm_disc_comm_amt,
    statu_ernd_volm_disc_prem_amt as statu_ernd_volm_disc_prem_amt,
    surty_prem_amt as surty_prem_amt,
    ulae_amt as ulae_amt,
    volm_disc_comm_amt as volm_disc_comm_amt,
    volm_disc_prem_amt as volm_disc_prem_amt,
    prem_tax_amt as prem_tax_amt,
    asset_def_fee_amt as asset_def_fee_amt,
    ctry_cd as ctry_cd,
    retro_cede_ind as retro_cede_ind,
    sys_prcg_cd as sys_prcg_cd,
    mgmt_cede_fee_amt as mgmt_cede_fee_amt,
    mgmt_excs_tax_amt as mgmt_excs_tax_amt,
    mgmt_prem_tax_amt as mgmt_prem_tax_amt,
    statu_cede_fee_amt as statu_cede_fee_amt,
    statu_ernd_contrtrnsfr_fee_amt as statu_ernd_contrtrnsfr_fee_amt,
    statu_excs_tax_amt as statu_excs_tax_amt,
    statu_prem_tax_amt as statu_prem_tax_amt,
    pop_info_id as pop_info_id,
    updt_pop_info_id as updt_pop_info_id,
    bat_id as bat_id,
    eff_frm_tistmp as eff_fm_tistmp,
    eff_to_tistmp as eff_to_tistmp,
    stat_comm_amt as stat_comm_amt,
    drvd_finc_los_catg_cd as drvd_finc_los_catg_cd,
    claim_loss_adj_charge_amt as claim_loss_adj_charge_amt,
    mgmt_ernd_scs_prem_comm_amt_1 as mgmt_ernd_scs_prem_comm_amt_1,
    mgmt_ernd_scs_prem_comm_amt_2 as mgmt_ernd_scs_prem_comm_amt_2,
    mgmt_ernd_scs_prem_comm_amt_3 as mgmt_ernd_scs_prem_comm_amt_3,
    mgmt_ernd_scs_prem_comm_amt_4 as mgmt_ernd_scs_prem_comm_amt_4,
    mgmt_ernd_scs_prem_comm_amt_5 as mgmt_ernd_scs_prem_comm_amt_5,
    statu_ernd_scs_prem_comm_amt_1 as statu_ernd_scs_prem_comm_amt_1,
    statu_ernd_scs_prem_comm_amt_2 as statu_ernd_scs_prem_comm_amt_2,
    statu_ernd_scs_prem_comm_amt_3 as statu_ernd_scs_prem_comm_amt_3,
    statu_ernd_scs_prem_comm_amt_4 as statu_ernd_scs_prem_comm_amt_4,
    statu_ernd_scs_prem_comm_amt_5 as statu_ernd_scs_prem_comm_amt_5,
    scs_prem_comm_amt_1 as scs_prem_comm_amt_1,
    scs_prem_comm_amt_2 as scs_prem_comm_amt_2,
    scs_prem_comm_amt_3 as scs_prem_comm_amt_3,
    scs_prem_comm_amt_4 as scs_prem_comm_amt_4,
    scs_prem_comm_amt_5 as scs_prem_comm_amt_5
from exp_tgt_anchor
